var Ls=Object.defineProperty,Ms=Object.defineProperties;var Us=Object.getOwnPropertyDescriptors;var St=Object.getOwnPropertySymbols;var Vn=Object.prototype.hasOwnProperty,Kn=Object.prototype.propertyIsEnumerable;var Yn=(r,e,t)=>e in r?Ls(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Se=(r,e)=>{for(var t in e||(e={}))Vn.call(e,t)&&Yn(r,t,e[t]);if(St)for(var t of St(e))Kn.call(e,t)&&Yn(r,t,e[t]);return r},Dt=(r,e)=>Ms(r,Us(e));var Xn=(r,e)=>{var t={};for(var n in r)Vn.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&St)for(var n of St(r))e.indexOf(n)<0&&Kn.call(r,n)&&(t[n]=r[n]);return t};const Bs=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}};Bs();function U(){}const Sn=r=>r;function Fs(r,e){for(const t in e)r[t]=e[t];return r}function Ur(r){return r()}function Qn(){return Object.create(null)}function ke(r){r.forEach(Ur)}function at(r){return typeof r=="function"}function be(r,e){return r!=r?e==e:r!==e||r&&typeof r=="object"||typeof r=="function"}let At;function er(r,e){return At||(At=document.createElement("a")),At.href=e,r===At.href}function Hs(r){return Object.keys(r).length===0}function Gs(r,...e){if(r==null)return U;const t=r.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Br(r,e,t){r.$$.on_destroy.push(Gs(e,t))}function Fr(r,e,t,n){if(r){const s=Hr(r,e,t,n);return r[0](s)}}function Hr(r,e,t,n){return r[1]&&n?Fs(t.ctx.slice(),r[1](n(e))):t.ctx}function Gr(r,e,t,n){if(r[2]&&n){const s=r[2](n(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const i=[],o=Math.max(e.dirty.length,s.length);for(let a=0;a<o;a+=1)i[a]=e.dirty[a]|s[a];return i}return e.dirty|s}return e.dirty}function zr(r,e,t,n,s,i){if(s){const o=Hr(e,t,n,i);r.p(o,s)}}function qr(r){if(r.ctx.length>32){const e=[],t=r.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function tr(r){return r==null?"":r}function Zt(r){return r&&at(r.destroy)?r.destroy:U}const Wr=typeof window!="undefined";let Jr=Wr?()=>window.performance.now():()=>Date.now(),Dn=Wr?r=>requestAnimationFrame(r):U;const Xe=new Set;function Zr(r){Xe.forEach(e=>{e.c(r)||(Xe.delete(e),e.f())}),Xe.size!==0&&Dn(Zr)}function Yr(r){let e;return Xe.size===0&&Dn(Zr),{promise:new Promise(t=>{Xe.add(e={c:r,f:t})}),abort(){Xe.delete(e)}}}function D(r,e){r.appendChild(e)}function Vr(r){if(!r)return document;const e=r.getRootNode?r.getRootNode():r.ownerDocument;return e&&e.host?e:r.ownerDocument}function zs(r){const e=I("style");return qs(Vr(r),e),e.sheet}function qs(r,e){D(r.head||r,e)}function N(r,e,t){r.insertBefore(e,t||null)}function x(r){r.parentNode.removeChild(r)}function Ws(r,e){for(let t=0;t<r.length;t+=1)r[t]&&r[t].d(e)}function I(r){return document.createElement(r)}function Lt(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function me(r){return document.createTextNode(r)}function z(){return me(" ")}function gt(){return me("")}function Y(r,e,t,n){return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}function An(r){return function(e){return e.preventDefault(),r.call(this,e)}}function k(r,e,t){t==null?r.removeAttribute(e):r.getAttribute(e)!==t&&r.setAttribute(e,t)}function Js(r){return Array.from(r.childNodes)}function We(r,e){e=""+e,r.wholeText!==e&&(r.data=e)}function nt(r,e){r.value=e==null?"":e}function Ve(r,e,t){r.classList[t?"add":"remove"](e)}function Kr(r,e,t=!1){const n=document.createEvent("CustomEvent");return n.initCustomEvent(r,t,!1,e),n}const Mt=new Map;let Ut=0;function Zs(r){let e=5381,t=r.length;for(;t--;)e=(e<<5)-e^r.charCodeAt(t);return e>>>0}function Ys(r,e){const t={stylesheet:zs(e),rules:{}};return Mt.set(r,t),t}function Xr(r,e,t,n,s,i,o,a=0){const c=16.666/n;let u=`{
`;for(let y=0;y<=1;y+=c){const E=e+(t-e)*i(y);u+=y*100+`%{${o(E,1-E)}}
`}const l=u+`100% {${o(t,1-t)}}
}`,h=`__svelte_${Zs(l)}_${a}`,f=Vr(r),{stylesheet:g,rules:m}=Mt.get(f)||Ys(f,r);m[h]||(m[h]=!0,g.insertRule(`@keyframes ${h} ${l}`,g.cssRules.length));const $=r.style.animation||"";return r.style.animation=`${$?`${$}, `:""}${h} ${n}ms linear ${s}ms 1 both`,Ut+=1,h}function un(r,e){const t=(r.style.animation||"").split(", "),n=t.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),s=t.length-n.length;s&&(r.style.animation=n.join(", "),Ut-=s,Ut||Vs())}function Vs(){Dn(()=>{Ut||(Mt.forEach(r=>{const{stylesheet:e}=r;let t=e.cssRules.length;for(;t--;)e.deleteRule(t);r.rules={}}),Mt.clear())})}function Ks(r,e,t,n){if(!e)return U;const s=r.getBoundingClientRect();if(e.left===s.left&&e.right===s.right&&e.top===s.top&&e.bottom===s.bottom)return U;const{delay:i=0,duration:o=300,easing:a=Sn,start:c=Jr()+i,end:u=c+o,tick:l=U,css:h}=t(r,{from:e,to:s},n);let f=!0,g=!1,m;function $(){h&&(m=Xr(r,0,1,o,i,a,h)),i||(g=!0)}function y(){h&&un(r,m),f=!1}return Yr(E=>{if(!g&&E>=c&&(g=!0),g&&E>=u&&(l(1,0),y()),!f)return!1;if(g){const O=E-c,L=0+1*a(O/o);l(L,1-L)}return!0}),$(),l(0,1),y}function Xs(r){const e=getComputedStyle(r);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:t,height:n}=e,s=r.getBoundingClientRect();r.style.position="absolute",r.style.width=t,r.style.height=n,Qs(r,s)}}function Qs(r,e){const t=r.getBoundingClientRect();if(e.left!==t.left||e.top!==t.top){const n=getComputedStyle(r),s=n.transform==="none"?"":n.transform;r.style.transform=`${s} translate(${e.left-t.left}px, ${e.top-t.top}px)`}}let _t;function pt(r){_t=r}function Yt(){if(!_t)throw new Error("Function called outside component initialization");return _t}function wt(r){Yt().$$.on_mount.push(r)}function Rn(){const r=Yt();return(e,t)=>{const n=r.$$.callbacks[e];if(n){const s=Kr(e,t);n.slice().forEach(i=>{i.call(r,s)})}}}function ei(r,e){Yt().$$.context.set(r,e)}function In(r){return Yt().$$.context.get(r)}const dt=[],rt=[],jt=[],hn=[],Qr=Promise.resolve();let dn=!1;function es(){dn||(dn=!0,Qr.then(ts))}function nr(){return es(),Qr}function Le(r){jt.push(r)}function Cn(r){hn.push(r)}const an=new Set;let Rt=0;function ts(){const r=_t;do{for(;Rt<dt.length;){const e=dt[Rt];Rt++,pt(e),ti(e.$$)}for(pt(null),dt.length=0,Rt=0;rt.length;)rt.pop()();for(let e=0;e<jt.length;e+=1){const t=jt[e];an.has(t)||(an.add(t),t())}jt.length=0}while(dt.length);for(;hn.length;)hn.pop()();dn=!1,an.clear(),pt(r)}function ti(r){if(r.fragment!==null){r.update(),ke(r.before_update);const e=r.dirty;r.dirty=[-1],r.fragment&&r.fragment.p(r.ctx,e),r.after_update.forEach(Le)}}let ct;function ni(){return ct||(ct=Promise.resolve(),ct.then(()=>{ct=null})),ct}function rr(r,e,t){r.dispatchEvent(Kr(`${e?"intro":"outro"}${t}`))}const Pt=new Set;let ze;function Re(){ze={r:0,c:[],p:ze}}function Ie(){ze.r||ke(ze.c),ze=ze.p}function C(r,e){r&&r.i&&(Pt.delete(r),r.i(e))}function P(r,e,t,n){if(r&&r.o){if(Pt.has(r))return;Pt.add(r),ze.c.push(()=>{Pt.delete(r),n&&(t&&r.d(1),n())}),r.o(e)}}const ri={duration:0};function Vt(r,e,t){let n=e(r,t),s=!1,i,o,a=0;function c(){i&&un(r,i)}function u(){const{delay:h=0,duration:f=300,easing:g=Sn,tick:m=U,css:$}=n||ri;$&&(i=Xr(r,0,1,f,h,g,$,a++)),m(0,1);const y=Jr()+h,E=y+f;o&&o.abort(),s=!0,Le(()=>rr(r,!0,"start")),o=Yr(O=>{if(s){if(O>=E)return m(1,0),rr(r,!0,"end"),c(),s=!1;if(O>=y){const L=g((O-y)/f);m(L,1-L)}}return s})}let l=!1;return{start(){l||(l=!0,un(r),at(n)?(n=n(),ni().then(u)):u())},invalidate(){l=!1},end(){s&&(c(),s=!1)}}}function ns(r,e){P(r,1,1,()=>{e.delete(r.key)})}function si(r,e){r.f(),ns(r,e)}function rs(r,e,t,n,s,i,o,a,c,u,l,h){let f=r.length,g=i.length,m=f;const $={};for(;m--;)$[r[m].key]=m;const y=[],E=new Map,O=new Map;for(m=g;m--;){const T=h(s,i,m),v=t(T);let S=o.get(v);S?n&&S.p(T,e):(S=u(v,T),S.c()),E.set(v,y[m]=S),v in $&&O.set(v,Math.abs(m-$[v]))}const L=new Set,B=new Set;function _(T){C(T,1),T.m(a,l),o.set(T.key,T),l=T.first,g--}for(;f&&g;){const T=y[g-1],v=r[f-1],S=T.key,M=v.key;T===v?(l=T.first,f--,g--):E.has(M)?!o.has(S)||L.has(S)?_(T):B.has(M)?f--:O.get(S)>O.get(M)?(B.add(S),_(T)):(L.add(M),f--):(c(v,o),f--)}for(;f--;){const T=r[f];E.has(T.key)||c(T,o)}for(;g;)_(y[g-1]);return y}function jn(r,e,t){const n=r.$$.props[e];n!==void 0&&(r.$$.bound[n]=t,t(r.$$.ctx[n]))}function ne(r){r&&r.c()}function K(r,e,t,n){const{fragment:s,on_mount:i,on_destroy:o,after_update:a}=r.$$;s&&s.m(e,t),n||Le(()=>{const c=i.map(Ur).filter(at);o?o.push(...c):ke(c),r.$$.on_mount=[]}),a.forEach(Le)}function X(r,e){const t=r.$$;t.fragment!==null&&(ke(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function ii(r,e){r.$$.dirty[0]===-1&&(dt.push(r),es(),r.$$.dirty.fill(0)),r.$$.dirty[e/31|0]|=1<<e%31}function $e(r,e,t,n,s,i,o,a=[-1]){const c=_t;pt(r);const u=r.$$={fragment:null,ctx:null,props:i,update:U,not_equal:s,bound:Qn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Qn(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};o&&o(u.root);let l=!1;if(u.ctx=t?t(r,e.props||{},(h,f,...g)=>{const m=g.length?g[0]:f;return u.ctx&&s(u.ctx[h],u.ctx[h]=m)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](m),l&&ii(r,h)),f}):[],u.update(),l=!0,ke(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const h=Js(e.target);u.fragment&&u.fragment.l(h),h.forEach(x)}else u.fragment&&u.fragment.c();e.intro&&C(r.$$.fragment),K(r,e.target,e.anchor,e.customElement),ts()}pt(c)}class Oe{$destroy(){X(this,1),this.$destroy=U}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const s=n.indexOf(t);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!Hs(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Je=[];function Pn(r,e=U){let t;const n=new Set;function s(a){if(be(r,a)&&(r=a,t)){const c=!Je.length;for(const u of n)u[1](),Je.push(u,r);if(c){for(let u=0;u<Je.length;u+=2)Je[u][0](Je[u+1]);Je.length=0}}}function i(a){s(a(r))}function o(a,c=U){const u=[a,c];return n.add(u),n.size===1&&(t=e(s)||U),a(r),()=>{n.delete(u),n.size===0&&(t(),t=null)}}return{set:s,update:i,subscribe:o}}function fn(r,e=!1){return r=r.slice(r.startsWith("/#")?2:0,r.endsWith("/*")?-2:void 0),r.startsWith("/")||(r="/"+r),r==="/"&&(r=""),e&&!r.endsWith("/")&&(r+="/"),r}function oi(r,e){r=fn(r,!0),e=fn(e,!0);let t=[],n={},s=!0,i=r.split("/").map(a=>a.startsWith(":")?(t.push(a.slice(1)),"([^\\/]+)"):a).join("\\/"),o=e.match(new RegExp(`^${i}$`));return o||(s=!1,o=e.match(new RegExp(`^${i}`))),o?(t.forEach((a,c)=>n[a]=o[c+1]),{exact:s,params:n,part:o[0].slice(0,-1)}):null}function sr(r,e,t){if(t==="")return r;if(t[0]==="/")return t;let n=o=>o.split("/").filter(a=>a!==""),s=n(r),i=e?n(e):[];return"/"+i.map((o,a)=>s[a]).join("/")+"/"+t}function ir(r,e,t,n){let s=[e,"data-"+e].reduce((i,o)=>{let a=r.getAttribute(o);return t&&r.removeAttribute(o),a===null?i:a},!1);return!n&&s===""?!0:s||n||!1}function ai(r){let e=r.split("&").map(t=>t.split("=")).reduce((t,n)=>{let s=n[0];if(!s)return t;let i=n.length>1?n[n.length-1]:!0;return typeof i=="string"&&i.includes(",")&&(i=i.split(",")),t[s]===void 0?t[s]=[i]:t[s].push(i),t},{});return Object.entries(e).reduce((t,n)=>(t[n[0]]=n[1].length>1?n[1]:n[1][0],t),{})}function li(r){throw new Error("[Tinro] "+r)}var xn=1,ss=2,is=3,ci=4;function ui(r,e,t,n){return r===xn?e&&e():r===ss?t&&t():n&&n()}function hi(){return!window||window.location.pathname==="srcdoc"?is:xn}var _e={HISTORY:xn,HASH:ss,MEMORY:is,OFF:ci,run:ui,getDeafault:hi},or,Nn,De=di();function di(){let r=_e.getDeafault(),e,t=i=>window.onhashchange=window.onpopstate=Nn=null,n=i=>e&&e(ar(r));function s(i){i&&(r=i),t(),r!==_e.OFF&&_e.run(r,o=>window.onpopstate=n,o=>window.onhashchange=n)&&n()}return{mode:i=>s(i),get:i=>ar(r),go(i,o){fi(r,i,o),n()},start(i){e=i,s()},stop(){e=null,s(_e.OFF)}}}function fi(r,e,t){let n=s=>history[t?"replaceState":"pushState"]({},"",s);_e.run(r,s=>n(e),s=>n(`#${e}`),s=>Nn=e)}function ar(r){let e=or,t=or=_e.run(r,s=>window.location.pathname+window.location.search,s=>String(window.location.hash.slice(1)||"/"),s=>Nn||"/"),n=t.match(/^([^?#]+)(?:\?([^#]+))?(?:\#(.+))?$/);return{url:t,from:e,path:n[1]||"",query:ai(n[2]||""),hash:n[3]||""}}function pi(r){let e=In("tinro");e&&(e.exact||e.fallback)&&li(`${r.fallback?"<Route fallback>":`<Route path="${r.path}">`}  can't be inside ${e.fallback?"<Route fallback>":`<Route path="${e.path||"/"}"> with exact path`}`);let t=r.fallback?"fallbacks":"childs",n=Pn({}),s={router:{},exact:!1,pattern:null,meta:{},parent:e,fallback:r.fallback,redirect:!1,firstmatch:!1,breadcrumb:null,matched:!1,childs:new Set,activeChilds:new Set,fallbacks:new Set,update(i){s.exact=!i.path.endsWith("/*"),s.pattern=fn(`${s.parent&&s.parent.pattern||""}${i.path}`),s.redirect=i.redirect,s.firstmatch=i.firstmatch,s.breadcrumb=i.breadcrumb,s.match()},register:()=>{if(s.parent)return s.parent[t].add(s),()=>{s.parent[t].delete(s),s.router.un&&s.router.un()}},show:()=>{r.onShow(),!s.fallback&&s.parent&&s.parent.activeChilds.add(s)},hide:()=>{r.onHide(),!s.fallback&&s.parent&&s.parent.activeChilds.delete(s)},match:async()=>{s.matched=!1;let{path:i,url:o,from:a,query:c}=s.router,u=oi(s.pattern,i);if(!s.fallback&&u&&s.redirect&&(!s.exact||s.exact&&u.exact)){await nr();let l=sr(i,s.parent&&s.parent.pattern,s.redirect);return xt.goto(l,!0)}if(s.meta=u&&{from:a,url:o,query:c,match:u.part,pattern:s.pattern,breadcrumbs:s.parent&&s.parent.meta&&s.parent.meta.breadcrumbs.slice()||[],params:u.params,subscribe:n.subscribe},s.breadcrumb&&s.meta&&s.meta.breadcrumbs.push({name:s.breadcrumb,path:u.part}),n.set(s.meta),u&&!s.fallback&&(!s.exact||s.exact&&u.exact)&&(!s.parent||!s.parent.firstmatch||!s.parent.matched)?(r.onMeta(s.meta),s.parent&&(s.parent.matched=!0),s.show()):s.hide(),await nr(),u&&!s.fallback&&(s.childs.size>0&&s.activeChilds.size==0||s.childs.size==0&&s.fallbacks.size>0)){let l=s;for(;l.fallbacks.size==0;)if(l=l.parent,!l)return;l&&l.fallbacks.forEach(h=>{if(h.redirect){let f=sr("/",h.parent&&h.parent.pattern,h.redirect);xt.goto(f,!0)}else h.show()})}}};return ei("tinro",s),wt(()=>s.register()),s.router.un=xt.subscribe(i=>{s.router.path=i.path,s.router.url=i.url,s.router.query=i.query,s.router.from=i.from,s.pattern!==null&&s.match()}),s}function mi(){return In("tinro").meta}var xt=gi();function gi(){let{subscribe:r}=Pn(De.get(),e=>{De.start(e);let t=_i(De.go);return()=>{De.stop(),t()}});return{subscribe:r,goto:De.go,params:vi,meta:mi,useHashNavigation:e=>De.mode(e?_e.HASH:_e.HISTORY),mode:{hash:()=>De.mode(_e.HASH),history:()=>De.mode(_e.HISTORY),memory:()=>De.mode(_e.MEMORY)}}}function _i(r){let e=t=>{let n=t.target.closest("a[href]"),s=n&&ir(n,"target",!1,"_self"),i=n&&ir(n,"tinro-ignore"),o=t.ctrlKey||t.metaKey||t.altKey||t.shiftKey;if(s=="_self"&&!i&&!o&&n){let a=n.getAttribute("href").replace(/^\/#/,"");/^\/\/|^[a-zA-Z]+:/.test(a)||(t.preventDefault(),r(a.startsWith("/")?a:n.href.replace(window.location.origin,"")))}};return addEventListener("click",e),()=>removeEventListener("click",e)}function vi(){return In("tinro").meta.params}const yi=r=>({params:r&2,meta:r&4}),lr=r=>({params:r[1],meta:r[2]});function cr(r){let e;const t=r[9].default,n=Fr(t,r,r[8],lr);return{c(){n&&n.c()},m(s,i){n&&n.m(s,i),e=!0},p(s,i){n&&n.p&&(!e||i&262)&&zr(n,t,s,s[8],e?Gr(t,s[8],i,yi):qr(s[8]),lr)},i(s){e||(C(n,s),e=!0)},o(s){P(n,s),e=!1},d(s){n&&n.d(s)}}}function bi(r){let e,t,n=r[0]&&cr(r);return{c(){n&&n.c(),e=gt()},m(s,i){n&&n.m(s,i),N(s,e,i),t=!0},p(s,[i]){s[0]?n?(n.p(s,i),i&1&&C(n,1)):(n=cr(s),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Re(),P(n,1,1,()=>{n=null}),Ie())},i(s){t||(C(n),t=!0)},o(s){P(n),t=!1},d(s){n&&n.d(s),s&&x(e)}}}function wi(r,e,t){let{$$slots:n={},$$scope:s}=e,{path:i="/*"}=e,{fallback:o=!1}=e,{redirect:a=!1}=e,{firstmatch:c=!1}=e,{breadcrumb:u=null}=e,l=!1,h={},f={};const g=pi({fallback:o,onShow(){t(0,l=!0)},onHide(){t(0,l=!1)},onMeta(m){t(2,f=m),t(1,h=f.params)}});return r.$$set=m=>{"path"in m&&t(3,i=m.path),"fallback"in m&&t(4,o=m.fallback),"redirect"in m&&t(5,a=m.redirect),"firstmatch"in m&&t(6,c=m.firstmatch),"breadcrumb"in m&&t(7,u=m.breadcrumb),"$$scope"in m&&t(8,s=m.$$scope)},r.$$.update=()=>{r.$$.dirty&232&&g.update({path:i,redirect:a,firstmatch:c,breadcrumb:u})},[l,h,f,i,o,a,c,u,s,n]}class Bt extends Oe{constructor(e){super(),$e(this,e,wi,bi,be,{path:3,fallback:4,redirect:5,firstmatch:6,breadcrumb:7})}}const Ei="1.35.1",os={"X-Client-Info":`supabase-js/${Ei}`},Ti="supabase.auth.token";function ki(r){return r.replace(/\/$/,"")}const $i=()=>typeof window!="undefined";var Et=globalThis&&globalThis.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})};const Oi=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Si=(r,e)=>{if(typeof r.json!="function")return e(r);r.json().then(t=>e({message:Oi(t),status:(r==null?void 0:r.status)||500}))},Di=(r,e,t)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"||(n.headers=Object.assign({"Content-Type":"text/plain;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(t)),n};function Kt(r,e,t,n,s){return Et(this,void 0,void 0,function*(){return new Promise((i,o)=>{r(t,Di(e,n,s)).then(a=>{if(!a.ok)throw a;return n!=null&&n.noResolveJson?i:a.json()}).then(a=>i(a)).catch(a=>Si(a,o))})})}function ln(r,e,t){return Et(this,void 0,void 0,function*(){return Kt(r,"GET",e,t)})}function ie(r,e,t,n){return Et(this,void 0,void 0,function*(){return Kt(r,"POST",e,n,t)})}function ur(r,e,t,n){return Et(this,void 0,void 0,function*(){return Kt(r,"PUT",e,n,t)})}function Ai(r,e,t,n){return Et(this,void 0,void 0,function*(){return Kt(r,"DELETE",e,n,t)})}const Ri="1.22.13",Ii="http://localhost:9999",Ci={"X-Client-Info":`gotrue-js/${Ri}`},ut="supabase.auth.token",ji={name:"sb",lifetime:60*60*8,domain:"",path:"/",sameSite:"lax"};function Pi(r,e,t){const n=t||{},s=encodeURIComponent,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!i.test(r))throw new TypeError("argument name is invalid");const o=s(e);if(o&&!i.test(o))throw new TypeError("argument val is invalid");let a=r+"="+o;if(n.maxAge!=null){const c=n.maxAge-0;if(isNaN(c)||!isFinite(c))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(c)}if(n.domain){if(!i.test(n.domain))throw new TypeError("option domain is invalid");a+="; Domain="+n.domain}if(n.path){if(!i.test(n.path))throw new TypeError("option path is invalid");a+="; Path="+n.path}if(n.expires){if(typeof n.expires.toUTCString!="function")throw new TypeError("option expires is invalid");a+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(a+="; HttpOnly"),n.secure&&(a+="; Secure"),n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a}function xi(r){if(!r||!r.headers||!r.headers.host)throw new Error('The "host" request header is not available');const e=r.headers.host.indexOf(":")>-1&&r.headers.host.split(":")[0]||r.headers.host;return!(["localhost","127.0.0.1"].indexOf(e)>-1||e.endsWith(".local"))}function Ni(r,e){var t,n,s;return Pi(r.name,r.value,{maxAge:r.maxAge,expires:new Date(Date.now()+r.maxAge*1e3),httpOnly:!0,secure:e,path:(t=r.path)!==null&&t!==void 0?t:"/",domain:(n=r.domain)!==null&&n!==void 0?n:"",sameSite:(s=r.sameSite)!==null&&s!==void 0?s:"lax"})}function pn(r,e,t){const n=t.map(i=>Ni(i,xi(r))),s=e.getHeader("Set-Cookie");return s&&(s instanceof Array?Array.prototype.push.apply(n,s):typeof s=="string"&&n.push(s)),n}function It(r,e,t){e.setHeader("Set-Cookie",pn(r,e,t))}var as=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Li(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var mn={exports:{}};(function(r,e){var t=typeof self!="undefined"?self:as,n=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(o){var a={searchParams:"URLSearchParams"in i,iterable:"Symbol"in i&&"iterator"in Symbol,blob:"FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in i,arrayBuffer:"ArrayBuffer"in i};function c(d){return d&&DataView.prototype.isPrototypeOf(d)}if(a.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(d){return d&&u.indexOf(Object.prototype.toString.call(d))>-1};function h(d){if(typeof d!="string"&&(d=String(d)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(d))throw new TypeError("Invalid character in header field name");return d.toLowerCase()}function f(d){return typeof d!="string"&&(d=String(d)),d}function g(d){var p={next:function(){var j=d.shift();return{done:j===void 0,value:j}}};return a.iterable&&(p[Symbol.iterator]=function(){return p}),p}function m(d){this.map={},d instanceof m?d.forEach(function(p,j){this.append(j,p)},this):Array.isArray(d)?d.forEach(function(p){this.append(p[0],p[1])},this):d&&Object.getOwnPropertyNames(d).forEach(function(p){this.append(p,d[p])},this)}m.prototype.append=function(d,p){d=h(d),p=f(p);var j=this.map[d];this.map[d]=j?j+", "+p:p},m.prototype.delete=function(d){delete this.map[h(d)]},m.prototype.get=function(d){return d=h(d),this.has(d)?this.map[d]:null},m.prototype.has=function(d){return this.map.hasOwnProperty(h(d))},m.prototype.set=function(d,p){this.map[h(d)]=f(p)},m.prototype.forEach=function(d,p){for(var j in this.map)this.map.hasOwnProperty(j)&&d.call(p,this.map[j],j,this)},m.prototype.keys=function(){var d=[];return this.forEach(function(p,j){d.push(j)}),g(d)},m.prototype.values=function(){var d=[];return this.forEach(function(p){d.push(p)}),g(d)},m.prototype.entries=function(){var d=[];return this.forEach(function(p,j){d.push([j,p])}),g(d)},a.iterable&&(m.prototype[Symbol.iterator]=m.prototype.entries);function $(d){if(d.bodyUsed)return Promise.reject(new TypeError("Already read"));d.bodyUsed=!0}function y(d){return new Promise(function(p,j){d.onload=function(){p(d.result)},d.onerror=function(){j(d.error)}})}function E(d){var p=new FileReader,j=y(p);return p.readAsArrayBuffer(d),j}function O(d){var p=new FileReader,j=y(p);return p.readAsText(d),j}function L(d){for(var p=new Uint8Array(d),j=new Array(p.length),re=0;re<p.length;re++)j[re]=String.fromCharCode(p[re]);return j.join("")}function B(d){if(d.slice)return d.slice(0);var p=new Uint8Array(d.byteLength);return p.set(new Uint8Array(d)),p.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(d){this._bodyInit=d,d?typeof d=="string"?this._bodyText=d:a.blob&&Blob.prototype.isPrototypeOf(d)?this._bodyBlob=d:a.formData&&FormData.prototype.isPrototypeOf(d)?this._bodyFormData=d:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)?this._bodyText=d.toString():a.arrayBuffer&&a.blob&&c(d)?(this._bodyArrayBuffer=B(d.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(d)||l(d))?this._bodyArrayBuffer=B(d):this._bodyText=d=Object.prototype.toString.call(d):this._bodyText="",this.headers.get("content-type")||(typeof d=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var d=$(this);if(d)return d;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?$(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(E)}),this.text=function(){var d=$(this);if(d)return d;if(this._bodyBlob)return O(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(M)}),this.json=function(){return this.text().then(JSON.parse)},this}var T=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(d){var p=d.toUpperCase();return T.indexOf(p)>-1?p:d}function S(d,p){p=p||{};var j=p.body;if(d instanceof S){if(d.bodyUsed)throw new TypeError("Already read");this.url=d.url,this.credentials=d.credentials,p.headers||(this.headers=new m(d.headers)),this.method=d.method,this.mode=d.mode,this.signal=d.signal,!j&&d._bodyInit!=null&&(j=d._bodyInit,d.bodyUsed=!0)}else this.url=String(d);if(this.credentials=p.credentials||this.credentials||"same-origin",(p.headers||!this.headers)&&(this.headers=new m(p.headers)),this.method=v(p.method||this.method||"GET"),this.mode=p.mode||this.mode||null,this.signal=p.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&j)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(j)}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function M(d){var p=new FormData;return d.trim().split("&").forEach(function(j){if(j){var re=j.split("="),Q=re.shift().replace(/\+/g," "),F=re.join("=").replace(/\+/g," ");p.append(decodeURIComponent(Q),decodeURIComponent(F))}}),p}function A(d){var p=new m,j=d.replace(/\r?\n[\t ]+/g," ");return j.split(/\r?\n/).forEach(function(re){var Q=re.split(":"),F=Q.shift().trim();if(F){var Ot=Q.join(":").trim();p.append(F,Ot)}}),p}_.call(S.prototype);function R(d,p){p||(p={}),this.type="default",this.status=p.status===void 0?200:p.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in p?p.statusText:"OK",this.headers=new m(p.headers),this.url=p.url||"",this._initBody(d)}_.call(R.prototype),R.prototype.clone=function(){return new R(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},R.error=function(){var d=new R(null,{status:0,statusText:""});return d.type="error",d};var b=[301,302,303,307,308];R.redirect=function(d,p){if(b.indexOf(p)===-1)throw new RangeError("Invalid status code");return new R(null,{status:p,headers:{location:d}})},o.DOMException=i.DOMException;try{new o.DOMException}catch{o.DOMException=function(p,j){this.message=p,this.name=j;var re=Error(p);this.stack=re.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function w(d,p){return new Promise(function(j,re){var Q=new S(d,p);if(Q.signal&&Q.signal.aborted)return re(new o.DOMException("Aborted","AbortError"));var F=new XMLHttpRequest;function Ot(){F.abort()}F.onload=function(){var lt={status:F.status,statusText:F.statusText,headers:A(F.getAllResponseHeaders()||"")};lt.url="responseURL"in F?F.responseURL:lt.headers.get("X-Request-URL");var on="response"in F?F.response:F.responseText;j(new R(on,lt))},F.onerror=function(){re(new TypeError("Network request failed"))},F.ontimeout=function(){re(new TypeError("Network request failed"))},F.onabort=function(){re(new o.DOMException("Aborted","AbortError"))},F.open(Q.method,Q.url,!0),Q.credentials==="include"?F.withCredentials=!0:Q.credentials==="omit"&&(F.withCredentials=!1),"responseType"in F&&a.blob&&(F.responseType="blob"),Q.headers.forEach(function(lt,on){F.setRequestHeader(on,lt)}),Q.signal&&(Q.signal.addEventListener("abort",Ot),F.onreadystatechange=function(){F.readyState===4&&Q.signal.removeEventListener("abort",Ot)}),F.send(typeof Q._bodyInit=="undefined"?null:Q._bodyInit)})}return w.polyfill=!0,i.fetch||(i.fetch=w,i.Headers=m,i.Request=S,i.Response=R),o.Headers=m,o.Request=S,o.Response=R,o.fetch=w,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,r.exports=e})(mn,mn.exports);var Xt=Li(mn.exports);function Ce(r){return Math.round(Date.now()/1e3)+r}function Mi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const je=()=>typeof window!="undefined";function Pe(r,e){var t;e||(e=((t=window==null?void 0:window.location)===null||t===void 0?void 0:t.href)||""),r=r.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&#]"+r+"(=([^&#]*)|&|#|$)"),s=n.exec(e);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}const Ui=r=>{let e;return r?e=r:typeof fetch=="undefined"?e=Xt:e=fetch,(...t)=>e(...t)};var q=globalThis&&globalThis.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})};class Bi{constructor({url:e="",headers:t={},cookieOptions:n,fetch:s}){this.url=e,this.headers=t,this.cookieOptions=Object.assign(Object.assign({},ji),n),this.fetch=Ui(s)}_createRequestHeaders(e){const t=Object.assign({},this.headers);return t.Authorization=`Bearer ${e}`,t}cookieName(){var e;return(e=this.cookieOptions.name)!==null&&e!==void 0?e:""}getUrlForProvider(e,t){const n=[`provider=${encodeURIComponent(e)}`];return t!=null&&t.redirectTo&&n.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&n.push(`scopes=${encodeURIComponent(t.scopes)}`),`${this.url}/authorize?${n.join("&")}`}signUpWithEmail(e,t,n={}){return q(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="";n.redirectTo&&(i="?redirect_to="+encodeURIComponent(n.redirectTo));const o=yield ie(this.fetch,`${this.url}/signup${i}`,{email:e,password:t,data:n.data,gotrue_meta_security:{hcaptcha_token:n.captchaToken}},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=Ce(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}})}signInWithEmail(e,t,n={}){return q(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="?grant_type=password";n.redirectTo&&(i+="&redirect_to="+encodeURIComponent(n.redirectTo));const o=yield ie(this.fetch,`${this.url}/token${i}`,{email:e,password:t},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=Ce(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}})}signUpWithPhone(e,t,n={}){return q(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),i=yield ie(this.fetch,`${this.url}/signup`,{phone:e,password:t,data:n.data,gotrue_meta_security:{hcaptcha_token:n.captchaToken}},{headers:s}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ce(i.expires_in)),{data:o,error:null}}catch(s){return{data:null,error:s}}})}signInWithPhone(e,t){return q(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers),s="?grant_type=password",i=yield ie(this.fetch,`${this.url}/token${s}`,{phone:e,password:t},{headers:n}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ce(i.expires_in)),{data:o,error:null}}catch(n){return{data:null,error:n}}})}signInWithOpenIDConnect({id_token:e,nonce:t,client_id:n,issuer:s,provider:i}){return q(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),a="?grant_type=id_token",c=yield ie(this.fetch,`${this.url}/token${a}`,{id_token:e,nonce:t,client_id:n,issuer:s,provider:i},{headers:o}),u=Object.assign({},c);return u.expires_in&&(u.expires_at=Ce(c.expires_in)),{data:u,error:null}}catch(o){return{data:null,error:o}}})}sendMagicLinkEmail(e,t={}){var n;return q(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="";t.redirectTo&&(i+="?redirect_to="+encodeURIComponent(t.redirectTo));const o=(n=t.shouldCreateUser)!==null&&n!==void 0?n:!0;return{data:yield ie(this.fetch,`${this.url}/otp${i}`,{email:e,create_user:o,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}sendMobileOTP(e,t={}){var n;return q(this,void 0,void 0,function*(){try{const s=(n=t.shouldCreateUser)!==null&&n!==void 0?n:!0,i=Object.assign({},this.headers);return{data:yield ie(this.fetch,`${this.url}/otp`,{phone:e,create_user:s,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:i}),error:null}}catch(s){return{data:null,error:s}}})}signOut(e){return q(this,void 0,void 0,function*(){try{return yield ie(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(e),noResolveJson:!0}),{error:null}}catch(t){return{error:t}}})}verifyMobileOTP(e,t,n={}){return q(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),i=yield ie(this.fetch,`${this.url}/verify`,{phone:e,token:t,type:"sms",redirect_to:n.redirectTo},{headers:s}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ce(i.expires_in)),{data:o,error:null}}catch(s){return{data:null,error:s}}})}verifyOTP({email:e,phone:t,token:n,type:s="sms"},i={}){return q(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),a=yield ie(this.fetch,`${this.url}/verify`,{email:e,phone:t,token:n,type:s,redirect_to:i.redirectTo},{headers:o}),c=Object.assign({},a);return c.expires_in&&(c.expires_at=Ce(a.expires_in)),{data:c,error:null}}catch(o){return{data:null,error:o}}})}inviteUserByEmail(e,t={}){return q(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers);let s="";return t.redirectTo&&(s+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield ie(this.fetch,`${this.url}/invite${s}`,{email:e,data:t.data},{headers:n}),error:null}}catch(n){return{data:null,error:n}}})}resetPasswordForEmail(e,t={}){return q(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers);let s="";return t.redirectTo&&(s+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield ie(this.fetch,`${this.url}/recover${s}`,{email:e,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:n}),error:null}}catch(n){return{data:null,error:n}}})}refreshAccessToken(e){return q(this,void 0,void 0,function*(){try{const t=yield ie(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:e},{headers:this.headers}),n=Object.assign({},t);return n.expires_in&&(n.expires_at=Ce(t.expires_in)),{data:n,error:null}}catch(t){return{data:null,error:t}}})}setAuthCookie(e,t){e.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:n,session:s}=e.body;if(!n)throw new Error("Auth event missing!");if(n==="SIGNED_IN"){if(!s)throw new Error("Auth session missing!");It(e,t,[{key:"access-token",value:s.access_token},{key:"refresh-token",value:s.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}n==="SIGNED_OUT"&&It(e,t,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))),t.status(200).json({})}deleteAuthCookie(e,t,{redirectTo:n="/"}){return It(e,t,["access-token","refresh-token"].map(s=>({name:`${this.cookieName()}-${s}`,value:"",maxAge:-1}))),t.redirect(307,n)}getAuthCookieString(e,t){e.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:n,session:s}=e.body;if(!n)throw new Error("Auth event missing!");if(n==="SIGNED_IN"){if(!s)throw new Error("Auth session missing!");return pn(e,t,[{key:"access-token",value:s.access_token},{key:"refresh-token",value:s.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return n==="SIGNED_OUT"?pn(e,t,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))):t.getHeader("Set-Cookie")}generateLink(e,t,n={}){return q(this,void 0,void 0,function*(){try{return{data:yield ie(this.fetch,`${this.url}/admin/generate_link`,{type:e,email:t,password:n.password,data:n.data,redirect_to:n.redirectTo},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}createUser(e){return q(this,void 0,void 0,function*(){try{const t=yield ie(this.fetch,`${this.url}/admin/users`,e,{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}listUsers(){return q(this,void 0,void 0,function*(){try{return{data:(yield ln(this.fetch,`${this.url}/admin/users`,{headers:this.headers})).users,error:null}}catch(e){return{data:null,error:e}}})}getUserById(e){return q(this,void 0,void 0,function*(){try{return{data:yield ln(this.fetch,`${this.url}/admin/users/${e}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}getUserByCookie(e,t){return q(this,void 0,void 0,function*(){try{if(!e.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");const n=e.cookies[`${this.cookieName()}-access-token`],s=e.cookies[`${this.cookieName()}-refresh-token`];if(!n)throw new Error("No cookie found!");const{user:i,error:o}=yield this.getUser(n);if(o){if(!s)throw new Error("No refresh_token cookie found!");if(!t)throw new Error("You need to pass the res object to automatically refresh the session!");const{data:a,error:c}=yield this.refreshAccessToken(s);if(c)throw c;if(a)return It(e,t,[{key:"access-token",value:a.access_token},{key:"refresh-token",value:a.refresh_token}].map(u=>{var l;return{name:`${this.cookieName()}-${u.key}`,value:u.value,domain:this.cookieOptions.domain,maxAge:(l=this.cookieOptions.lifetime)!==null&&l!==void 0?l:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:a.access_token,user:a.user,data:a.user,error:null}}return{token:n,user:i,data:i,error:null}}catch(n){return{token:null,user:null,data:null,error:n}}})}updateUserById(e,t){return q(this,void 0,void 0,function*(){try{const n=yield ur(this.fetch,`${this.url}/admin/users/${e}`,t,{headers:this.headers});return{user:n,data:n,error:null}}catch(n){return{user:null,data:null,error:n}}})}deleteUser(e){return q(this,void 0,void 0,function*(){try{const t=yield Ai(this.fetch,`${this.url}/admin/users/${e}`,{},{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}getUser(e){return q(this,void 0,void 0,function*(){try{const t=yield ln(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(e)});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}updateUser(e,t){return q(this,void 0,void 0,function*(){try{const n=yield ur(this.fetch,`${this.url}/user`,t,{headers:this._createRequestHeaders(e)});return{user:n,data:n,error:null}}catch(n){return{user:null,data:null,error:n}}})}}function Fi(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self!="undefined"&&(self.globalThis=self)}}var le=globalThis&&globalThis.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})};Fi();const Hi={url:Ii,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:Ci};class Gi{constructor(e){this.stateChangeEmitters=new Map;const t=Object.assign(Object.assign({},Hi),e);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=t.autoRefreshToken,this.persistSession=t.persistSession,this.multiTab=t.multiTab,this.localStorage=t.localStorage||globalThis.localStorage,this.api=new Bi({url:t.url,headers:t.headers,cookieOptions:t.cookieOptions,fetch:t.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),t.detectSessionInUrl&&je()&&!!Pe("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:n})=>{n&&console.error("Error getting session from URL.",n)})}signUp({email:e,password:t,phone:n},s={}){return le(this,void 0,void 0,function*(){try{this._removeSession();const{data:i,error:o}=n&&t?yield this.api.signUpWithPhone(n,t,{data:s.data,captchaToken:s.captchaToken}):yield this.api.signUpWithEmail(e,t,{redirectTo:s.redirectTo,data:s.data,captchaToken:s.captchaToken});if(o)throw o;if(!i)throw"An error occurred on sign up.";let a=null,c=null;return i.access_token&&(a=i,c=a.user,this._saveSession(a),this._notifyAllSubscribers("SIGNED_IN")),i.id&&(c=i),{user:c,session:a,error:null}}catch(i){return{user:null,session:null,error:i}}})}signIn({email:e,phone:t,password:n,refreshToken:s,provider:i,oidc:o},a={}){return le(this,void 0,void 0,function*(){try{if(this._removeSession(),e&&!n){const{error:c}=yield this.api.sendMagicLinkEmail(e,{redirectTo:a.redirectTo,shouldCreateUser:a.shouldCreateUser,captchaToken:a.captchaToken});return{user:null,session:null,error:c}}if(e&&n)return this._handleEmailSignIn(e,n,{redirectTo:a.redirectTo});if(t&&!n){const{error:c}=yield this.api.sendMobileOTP(t,{shouldCreateUser:a.shouldCreateUser,captchaToken:a.captchaToken});return{user:null,session:null,error:c}}if(t&&n)return this._handlePhoneSignIn(t,n);if(s){const{error:c}=yield this._callRefreshToken(s);if(c)throw c;return{user:this.currentUser,session:this.currentSession,error:null}}if(i)return this._handleProviderSignIn(i,{redirectTo:a.redirectTo,scopes:a.scopes});if(o)return this._handleOpenIDConnectSignIn(o);throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.")}catch(c){return{user:null,session:null,error:c}}})}verifyOTP(e,t={}){return le(this,void 0,void 0,function*(){try{this._removeSession();const{data:n,error:s}=yield this.api.verifyOTP(e,t);if(s)throw s;if(!n)throw"An error occurred on token verification.";let i=null,o=null;return n.access_token&&(i=n,o=i.user,this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),n.id&&(o=n),{user:o,session:i,error:null}}catch(n){return{user:null,session:null,error:n}}})}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var e;return le(this,void 0,void 0,function*(){try{if(!(!((e=this.currentSession)===null||e===void 0)&&e.access_token))throw new Error("Not logged in.");const{error:t}=yield this._callRefreshToken();if(t)throw t;return{data:this.currentSession,user:this.currentUser,error:null}}catch(t){return{data:null,user:null,error:t}}})}update(e){var t;return le(this,void 0,void 0,function*(){try{if(!(!((t=this.currentSession)===null||t===void 0)&&t.access_token))throw new Error("Not logged in.");const{user:n,error:s}=yield this.api.updateUser(this.currentSession.access_token,e);if(s)throw s;if(!n)throw Error("Invalid user data.");const i=Object.assign(Object.assign({},this.currentSession),{user:n});return this._saveSession(i),this._notifyAllSubscribers("USER_UPDATED"),{data:n,user:n,error:null}}catch(n){return{data:null,user:null,error:n}}})}setSession(e){return le(this,void 0,void 0,function*(){try{if(!e)throw new Error("No current session.");const{data:t,error:n}=yield this.api.refreshAccessToken(e);return n?{session:null,error:n}:(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"),{session:t,error:null})}catch(t){return{error:t,session:null}}})}setAuth(e){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:e,token_type:"bearer",user:this.user()}),this._notifyAllSubscribers("TOKEN_REFRESHED"),this.currentSession}getSessionFromUrl(e){return le(this,void 0,void 0,function*(){try{if(!je())throw new Error("No browser detected.");const t=Pe("error_description");if(t)throw new Error(t);const n=Pe("provider_token"),s=Pe("access_token");if(!s)throw new Error("No access_token detected.");const i=Pe("expires_in");if(!i)throw new Error("No expires_in detected.");const o=Pe("refresh_token");if(!o)throw new Error("No refresh_token detected.");const a=Pe("token_type");if(!a)throw new Error("No token_type detected.");const u=Math.round(Date.now()/1e3)+parseInt(i),{user:l,error:h}=yield this.api.getUser(s);if(h)throw h;const f={provider_token:n,access_token:s,expires_in:parseInt(i),expires_at:u,refresh_token:o,token_type:a,user:l};if(e!=null&&e.storeSession){this._saveSession(f);const g=Pe("type");this._notifyAllSubscribers("SIGNED_IN"),g==="recovery"&&this._notifyAllSubscribers("PASSWORD_RECOVERY")}return window.location.hash="",{data:f,error:null}}catch(t){return{data:null,error:t}}})}signOut(){var e;return le(this,void 0,void 0,function*(){const t=(e=this.currentSession)===null||e===void 0?void 0:e.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),t){const{error:n}=yield this.api.signOut(t);if(n)return{error:n}}return{error:null}})}onAuthStateChange(e){try{const t=Mi(),n={id:t,callback:e,unsubscribe:()=>{this.stateChangeEmitters.delete(t)}};return this.stateChangeEmitters.set(t,n),{data:n,error:null}}catch(t){return{data:null,error:t}}}_handleEmailSignIn(e,t,n={}){var s,i;return le(this,void 0,void 0,function*(){try{const{data:o,error:a}=yield this.api.signInWithEmail(e,t,{redirectTo:n.redirectTo});return a||!o?{data:null,user:null,session:null,error:a}:((((s=o==null?void 0:o.user)===null||s===void 0?void 0:s.confirmed_at)||((i=o==null?void 0:o.user)===null||i===void 0?void 0:i.email_confirmed_at))&&(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN")),{data:o,user:o.user,session:o,error:null})}catch(o){return{data:null,user:null,session:null,error:o}}})}_handlePhoneSignIn(e,t){var n;return le(this,void 0,void 0,function*(){try{const{data:s,error:i}=yield this.api.signInWithPhone(e,t);return i||!s?{data:null,user:null,session:null,error:i}:(!((n=s==null?void 0:s.user)===null||n===void 0)&&n.phone_confirmed_at&&(this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN")),{data:s,user:s.user,session:s,error:null})}catch(s){return{data:null,user:null,session:null,error:s}}})}_handleProviderSignIn(e,t={}){const n=this.api.getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes});try{return je()&&(window.location.href=n),{provider:e,url:n,data:null,session:null,user:null,error:null}}catch(s){return n?{provider:e,url:n,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:s}}}_handleOpenIDConnectSignIn({id_token:e,nonce:t,client_id:n,issuer:s,provider:i}){return le(this,void 0,void 0,function*(){if(e&&t&&(n&&s||i))try{const{data:o,error:a}=yield this.api.signInWithOpenIDConnect({id_token:e,nonce:t,client_id:n,issuer:s,provider:i});return a||!o?{user:null,session:null,error:a}:(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN"),{user:o.user,session:o,error:null})}catch(o){return{user:null,session:null,error:o}}throw new Error("You must provide a OpenID Connect provider with your id token and nonce.")})}_recoverSession(){var e;try{const t=je()&&((e=this.localStorage)===null||e===void 0?void 0:e.getItem(ut));if(!t||typeof t!="string")return null;const n=JSON.parse(t),{currentSession:s,expiresAt:i}=n,o=Math.round(Date.now()/1e3);i>=o&&(s==null?void 0:s.user)&&(this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN"))}catch(t){console.log("error",t)}}_recoverAndRefresh(){return le(this,void 0,void 0,function*(){try{const e=je()&&(yield this.localStorage.getItem(ut));if(!e)return null;const t=JSON.parse(e),{currentSession:n,expiresAt:s}=t,i=Math.round(Date.now()/1e3);if(s<i)if(this.autoRefreshToken&&n.refresh_token){const{error:o}=yield this._callRefreshToken(n.refresh_token);o&&(console.log(o.message),yield this._removeSession())}else this._removeSession();else n?(this._saveSession(n),this._notifyAllSubscribers("SIGNED_IN")):(console.log("Current session is missing data."),this._removeSession())}catch(e){return console.error(e),null}})}_callRefreshToken(e){var t;return e===void 0&&(e=(t=this.currentSession)===null||t===void 0?void 0:t.refresh_token),le(this,void 0,void 0,function*(){try{if(!e)throw new Error("No current session.");const{data:n,error:s}=yield this.api.refreshAccessToken(e);if(s)throw s;if(!n)throw Error("Invalid session data.");return this._saveSession(n),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),{data:n,error:null}}catch(n){return{data:null,error:n}}})}_notifyAllSubscribers(e){this.stateChangeEmitters.forEach(t=>t.callback(e,this.currentSession))}_saveSession(e){this.currentSession=e,this.currentUser=e.user;const t=e.expires_at;if(t){const n=Math.round(Date.now()/1e3),s=t-n,i=s>60?60:.5;this._startAutoRefreshToken((s-i)*1e3)}this.persistSession&&e.expires_at&&this._persistSession(this.currentSession)}_persistSession(e){const t={currentSession:e,expiresAt:e.expires_at};je()&&this.localStorage.setItem(ut,JSON.stringify(t))}_removeSession(){return le(this,void 0,void 0,function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),je()&&(yield this.localStorage.removeItem(ut))})}_startAutoRefreshToken(e){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),!(e<=0||!this.autoRefreshToken)&&(this.refreshTokenTimer=setTimeout(()=>this._callRefreshToken(),e),typeof this.refreshTokenTimer.unref=="function"&&this.refreshTokenTimer.unref())}_listenForMultiTabEvents(){if(!this.multiTab||!je()||!(window!=null&&window.addEventListener))return!1;try{window==null||window.addEventListener("storage",e=>{var t;if(e.key===ut){const n=JSON.parse(String(e.newValue));!((t=n==null?void 0:n.currentSession)===null||t===void 0)&&t.access_token?(this._recoverAndRefresh(),this._notifyAllSubscribers("SIGNED_IN")):(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"))}})}catch(e){console.error("_listenForMultiTabEvents",e)}}}class zi extends Gi{constructor(e){super(e)}}var qi=globalThis&&globalThis.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})};class Ln{constructor(e){Object.assign(this,e);let t;e.fetch?t=e.fetch:typeof fetch=="undefined"?t=Xt:t=fetch,this.fetch=(...n)=>t(...n),this.shouldThrowOnError=e.shouldThrowOnError||!1}throwOnError(e){return e==null&&(e=!0),this.shouldThrowOnError=e,this}then(e,t){typeof this.schema=="undefined"||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let n=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(s=>qi(this,void 0,void 0,function*(){var i,o,a;let c=null,u=null,l=null;if(s.ok){const f=(i=this.headers.Prefer)===null||i===void 0?void 0:i.split(",").includes("return=minimal");if(this.method!=="HEAD"&&!f){const $=yield s.text();$&&(this.headers.Accept==="text/csv"?u=$:u=JSON.parse($))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),m=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");g&&m&&m.length>1&&(l=parseInt(m[1]))}else{const f=yield s.text();try{c=JSON.parse(f)}catch{c={message:f}}if(c&&this.shouldThrowOnError)throw c}return{error:c,data:u,count:l,status:s.status,statusText:s.statusText,body:u}}));return this.shouldThrowOnError||(n=n.catch(s=>({error:{message:`FetchError: ${s.message}`,details:"",hint:"",code:s.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),n.then(e,t)}}class Mn extends Ln{select(e="*"){let t=!1;const n=e.split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",n),this}order(e,{ascending:t=!0,nullsFirst:n=!1,foreignTable:s}={}){const i=typeof s=="undefined"?"order":`${s}.order`,o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}.${n?"nullsfirst":"nullslast"}`),this}limit(e,{foreignTable:t}={}){const n=typeof t=="undefined"?"limit":`${t}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:n}={}){const s=typeof n=="undefined"?"offset":`${n}.offset`,i=typeof n=="undefined"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){this.headers.Accept="application/vnd.pgrst.object+json";const e=new Mn(this);return e.then=(t,n)=>this.then(s=>{var i,o;return!((o=(i=s.error)===null||i===void 0?void 0:i.details)===null||o===void 0)&&o.includes("Results contain 0 rows")?t({error:null,data:null,count:s.count,status:200,statusText:"OK",body:null}):t(s)},n),e}csv(){return this.headers.Accept="text/csv",this}}class Ye extends Mn{constructor(){super(...arguments),this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(e,t,n){return this.url.searchParams.append(`${e}`,`not.${t}.${n}`),this}or(e,{foreignTable:t}={}){const n=typeof t=="undefined"?"or":`${t}.or`;return this.url.searchParams.append(n,`(${e})`),this}eq(e,t){return this.url.searchParams.append(`${e}`,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(`${e}`,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(`${e}`,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(`${e}`,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(`${e}`,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(`${e}`,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(`${e}`,`like.${t}`),this}ilike(e,t){return this.url.searchParams.append(`${e}`,`ilike.${t}`),this}is(e,t){return this.url.searchParams.append(`${e}`,`is.${t}`),this}in(e,t){const n=t.map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(`${e}`,`in.(${n})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(`${e}`,`cs.{${t.join(",")}}`):this.url.searchParams.append(`${e}`,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(`${e}`,`cd.{${t.join(",")}}`):this.url.searchParams.append(`${e}`,`cd.${JSON.stringify(t)}`),this}rangeLt(e,t){return this.url.searchParams.append(`${e}`,`sl.${t}`),this}rangeGt(e,t){return this.url.searchParams.append(`${e}`,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(`${e}`,`nxl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(`${e}`,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(`${e}`,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`ov.${t}`):this.url.searchParams.append(`${e}`,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:s=null}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(`${e}`,`${i}fts${o}.${t}`),this}fts(e,t,{config:n}={}){const s=typeof n=="undefined"?"":`(${n})`;return this.url.searchParams.append(`${e}`,`fts${s}.${t}`),this}plfts(e,t,{config:n}={}){const s=typeof n=="undefined"?"":`(${n})`;return this.url.searchParams.append(`${e}`,`plfts${s}.${t}`),this}phfts(e,t,{config:n}={}){const s=typeof n=="undefined"?"":`(${n})`;return this.url.searchParams.append(`${e}`,`phfts${s}.${t}`),this}wfts(e,t,{config:n}={}){const s=typeof n=="undefined"?"":`(${n})`;return this.url.searchParams.append(`${e}`,`wfts${s}.${t}`),this}filter(e,t,n){return this.url.searchParams.append(`${e}`,`${t}.${n}`),this}match(e){return Object.keys(e).forEach(t=>{this.url.searchParams.append(`${t}`,`eq.${e[t]}`)}),this}}class ls extends Ln{constructor(e,{headers:t={},schema:n,fetch:s,shouldThrowOnError:i}={}){super({fetch:s,shouldThrowOnError:i}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=n}select(e="*",{head:t=!1,count:n=null}={}){this.method="GET";let s=!1;const i=e.split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),t&&(this.method="HEAD"),new Ye(this)}insert(e,{upsert:t=!1,onConflict:n,returning:s="representation",count:i=null}={}){this.method="POST";const o=[`return=${s}`];if(t&&o.push("resolution=merge-duplicates"),t&&n!==void 0&&this.url.searchParams.set("on_conflict",n),this.body=e,i&&o.push(`count=${i}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),Array.isArray(e)){const a=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(a.length>0){const c=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ye(this)}upsert(e,{onConflict:t,returning:n="representation",count:s=null,ignoreDuplicates:i=!1}={}){this.method="POST";const o=[`resolution=${i?"ignore":"merge"}-duplicates`,`return=${n}`];return t!==void 0&&this.url.searchParams.set("on_conflict",t),this.body=e,s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new Ye(this)}update(e,{returning:t="representation",count:n=null}={}){this.method="PATCH";const s=[`return=${t}`];return this.body=e,n&&s.push(`count=${n}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Ye(this)}delete({returning:e="representation",count:t=null}={}){this.method="DELETE";const n=[`return=${e}`];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Ye(this)}}class Wi extends Ln{constructor(e,{headers:t={},schema:n,fetch:s,shouldThrowOnError:i}={}){super({fetch:s,shouldThrowOnError:i}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=n}rpc(e,{head:t=!1,count:n=null}={}){return t?(this.method="HEAD",e&&Object.entries(e).forEach(([s,i])=>{this.url.searchParams.append(s,i)})):(this.method="POST",this.body=e),n&&(this.headers.Prefer!==void 0?this.headers.Prefer+=`,count=${n}`:this.headers.Prefer=`count=${n}`),new Ye(this)}}const Ji="0.37.2",Zi={"X-Client-Info":`postgrest-js/${Ji}`};class Yi{constructor(e,{headers:t={},schema:n,fetch:s,throwOnError:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Zi),t),this.schema=n,this.fetch=s,this.shouldThrowOnError=i}auth(e){return this.headers.Authorization=`Bearer ${e}`,this}from(e){const t=`${this.url}/${e}`;return new ls(t,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:n=!1,count:s=null}={}){const i=`${this.url}/rpc/${e}`;return new Wi(i,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError}).rpc(t,{head:n,count:s})}}var H;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(H||(H={}));const hr=(r,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,o)=>(i[o]=Vi(o,r,e,s),i),{})},Vi=(r,e,t,n)=>{const s=e.find(a=>a.name===r),i=s==null?void 0:s.type,o=t[r];return i&&!n.includes(i)?cs(i,o):gn(o)},cs=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return eo(e,t)}switch(r){case H.bool:return Ki(e);case H.float4:case H.float8:case H.int2:case H.int4:case H.int8:case H.numeric:case H.oid:return Xi(e);case H.json:case H.jsonb:return Qi(e);case H.timestamp:return to(e);case H.abstime:case H.date:case H.daterange:case H.int4range:case H.int8range:case H.money:case H.reltime:case H.text:case H.time:case H.timestamptz:case H.timetz:case H.tsrange:case H.tstzrange:return gn(e);default:return gn(e)}},gn=r=>r,Ki=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Xi=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Qi=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},eo=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let i;const o=r.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>cs(e,a))}return r},to=r=>typeof r=="string"?r.replace(" ","T"):r,no="websocket",ro="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",so=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],io="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",oo=["I\xF1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],ao="1.0.34",lo={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},co="https://github.com/theturtle32/WebSocket-Node",uo={node:">=4.0.0"},ho={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},fo={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},po={verbose:!1},mo={test:"tape test/unit/*.js",gulp:"gulp"},go="index",_o={lib:"./lib"},vo="lib/browser.js",yo="Apache-2.0";var bo={name:no,description:ro,keywords:so,author:io,contributors:oo,version:ao,repository:lo,homepage:co,engines:uo,dependencies:ho,devDependencies:fo,config:po,scripts:mo,main:go,directories:_o,browser:vo,license:yo},wo=bo.version,Fe;if(typeof globalThis=="object")Fe=globalThis;else try{Fe=require("es5-ext/global")}catch{}finally{if(!Fe&&typeof window!="undefined"&&(Fe=window),!Fe)throw new Error("Could not determine global this")}var vt=Fe.WebSocket||Fe.MozWebSocket,Eo=wo;function us(r,e){var t;return e?t=new vt(r,e):t=new vt(r),t}vt&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(r){Object.defineProperty(us,r,{get:function(){return vt[r]}})});var To={w3cwebsocket:vt?us:null,version:Eo};const ko="1.7.1",$o={"X-Client-Info":`realtime-js/${ko}`},Oo="1.0.0",hs=1e4,So=1e3;var mt;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(mt||(mt={}));var G;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(G||(G={}));var Z;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Z||(Z={}));var _n;(function(r){r.websocket="websocket"})(_n||(_n={}));var He;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(He||(He={}));class Un{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Do{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+s));o=o+s;const c=n.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:c,payload:u}}}class Qe{constructor(e,t,n={},s=hs){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel instanceof vn?this.channel.on(this.refEvent,e):this.channel.on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel.trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){!this.refEvent||(this.channel instanceof vn?this.channel.off(this.refEvent):this.channel.off(this.refEvent,{}))}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}class vn{constructor(e,t={},n){this.topic=e,this.params=t,this.socket=n,this.bindings=[],this.state=G.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new Qe(this,Z.join,this.params,this.timeout),this.rejoinTimer=new Un(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=G.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=G.closed,this.socket.remove(this)}),this.onError(s=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=G.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=G.errored,this.rejoinTimer.scheduleTimeout())}),this.on(Z.reply,(s,i)=>{this.trigger(this.replyEventName(i),s)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(e),this.joinPush}onClose(e){this.on(Z.close,e)}onError(e){this.on(Z.error,t=>e(t))}on(e,t){this.bindings.push({event:e,callback:t})}off(e){this.bindings=this.bindings.filter(t=>t.event!==e)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Qe(this,e,t,n);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=G.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(Z.close,"leave",this.joinRef())};this.joinPush.destroy();let n=new Qe(this,Z.leave,{},e);return n.receive("ok",()=>t()).receive("timeout",()=>t()),n.send(),this.canPush()||n.trigger("ok",{}),n}onMessage(e,t,n){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=G.joining,this.joinPush.resend(e))}trigger(e,t,n){let{close:s,error:i,leave:o,join:a}=Z;if(n&&[s,i,o,a].indexOf(e)>=0&&n!==this.joinRef())return;let u=this.onMessage(e,t,n);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(l=>l.event==="*"?e===(t==null?void 0:t.type):l.event===e).map(l=>l.callback(u,n))}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===G.closed}isErrored(){return this.state===G.errored}isJoined(){return this.state===G.joined}isJoining(){return this.state===G.joining}isLeaving(){return this.state===G.leaving}}class Ke{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel.on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel.joinRef(),this.state=Ke.syncState(this.state,s,i,o),this.pendingDiffs.forEach(c=>{this.state=Ke.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],a()}),this.channel.on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ke.syncDiff(this.state,s,i,o),a())})}static syncState(e,t,n,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},c={};return this.map(i,(u,l)=>{o[u]||(c[u]=l)}),this.map(o,(u,l)=>{const h=i[u];if(h){const f=l.map(y=>y.presence_id),g=h.map(y=>y.presence_id),m=l.filter(y=>g.indexOf(y.presence_id)<0),$=h.filter(y=>f.indexOf(y.presence_id)<0);m.length>0&&(a[u]=m),$.length>0&&(c[u]=$)}else a[u]=l}),this.syncDiff(i,{joins:a,leaves:c},n,s)}static syncDiff(e,t,n,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(a,c)=>{const u=e[a];if(e[a]=this.cloneDeep(c),u){const l=e[a].map(f=>f.presence_id),h=u.filter(f=>l.indexOf(f.presence_id)<0);e[a].unshift(...h)}n(a,u,c)}),this.map(o,(a,c)=>{let u=e[a];if(!u)return;const l=c.map(h=>h.presence_id);u=u.filter(h=>l.indexOf(h.presence_id)<0),e[a]=u,s(a,u,c),u.length===0&&delete e[a]}),e}static list(e,t){return t||(t=(n,s)=>s),this.map(e,(n,s)=>t(n,s))}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(i=>(i.presence_id=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}list(e){return Ke.list(this.state,e)}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}}class Ft{constructor(e,t={},n){this.topic=e,this.params=t,this.socket=n,this.bindings=[],this.state=G.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new Qe(this,Z.join,this.params,this.timeout),this.rejoinTimer=new Un(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=G.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=G.closed,this.socket.remove(this)}),this.onError(s=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=G.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=G.errored,this.rejoinTimer.scheduleTimeout())}),this.on(Z.reply,{},(s,i)=>{this.trigger(this.replyEventName(i),s)}),this.presence=new Ke(this)}list(){return this.presence.list()}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const t=this.bindings.reduce((n,s)=>{const{type:i}=s;return["phx_close","phx_error","phx_reply","presence_diff","presence_state"].includes(i)||(n[i]=s),n},{});return Object.keys(t).length&&this.updateJoinPayload({configs:t}),this.joinedOnce=!0,this.rejoin(e),this.joinPush}}onClose(e){this.on(Z.close,{},e)}onError(e){this.on(Z.error,{},t=>e(t))}on(e,t,n){this.bindings.push({type:e,filter:t!=null?t:{},callback:n!=null?n:()=>{}})}off(e,t){this.bindings=this.bindings.filter(n=>!(n.type===e&&Ft.isEqual(n.filter,t)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Qe(this,e,t,n);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=G.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(Z.close,"leave",this.joinRef())};this.joinPush.destroy();const n=new Qe(this,Z.leave,{},e);return n.receive("ok",()=>t()).receive("timeout",()=>t()),n.send(),this.canPush()||n.trigger("ok",{}),n}onMessage(e,t,n){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=G.joining,this.joinPush.resend(e))}trigger(e,t,n){const{close:s,error:i,leave:o,join:a}=Z;if(n&&[s,i,o,a].indexOf(e)>=0&&n!==this.joinRef())return;const u=this.onMessage(e,t,n);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(l=>{var h,f;return(l==null?void 0:l.type)===e&&(((h=l==null?void 0:l.filter)===null||h===void 0?void 0:h.event)==="*"||((f=l==null?void 0:l.filter)===null||f===void 0?void 0:f.event)===(t==null?void 0:t.event))}).map(l=>l.callback(u,n))}send(e){const t=this.push(e.type,e);return new Promise((n,s)=>{t.receive("ok",()=>n("ok")),t.receive("timeout",()=>s("timeout"))})}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===G.closed}isErrored(){return this.state===G.errored}isJoined(){return this.state===G.joined}isJoining(){return this.state===G.joining}isLeaving(){return this.state===G.leaving}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}}var Ao=globalThis&&globalThis.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})},Ro=globalThis&&globalThis.__rest||function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};const Io=()=>{};class Co{constructor(e,t){this.accessToken=null,this.channels=[],this.endPoint="",this.headers=$o,this.params={},this.timeout=hs,this.transport=To.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Io,this.conn=null,this.sendBuffer=[],this.serializer=new Do,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.versionDate=void 0,this.endPoint=`${e}/${_n.websocket}`,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.transport&&(this.transport=t.transport),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs),t!=null&&t.longpollerTimeout&&(this.longpollerTimeout=t.longpollerTimeout),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:n=>[1e3,2e3,5e3,1e4][n-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(n,s)=>s(JSON.stringify(n)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Un(()=>Ao(this,void 0,void 0,function*(){yield this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){var e;if(!this.conn&&(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn)){this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=n=>this._onConnError(n),this.conn.onmessage=n=>this.onConnMessage(n),this.conn.onclose=n=>this._onConnClose(n);const t=new Date((e=new URL(this.conn.url).searchParams.get("vsndate"))!==null&&e!==void 0?e:"");t.toString()!=="Invalid Date"&&(this.versionDate=t)}}disconnect(e,t){return new Promise((n,s)=>{try{this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),n({error:null,data:!0})}catch(i){n({error:i,data:!1})}})}log(e,t,n){this.logger(e,t,n)}onOpen(e){this.stateChangeCallbacks.open.push(e)}onClose(e){this.stateChangeCallbacks.close.push(e)}onError(e){this.stateChangeCallbacks.error.push(e)}onMessage(e){this.stateChangeCallbacks.message.push(e)}connectionState(){switch(this.conn&&this.conn.readyState){case mt.connecting:return He.Connecting;case mt.open:return He.Open;case mt.closing:return He.Closing;default:return He.Closed}}isConnected(){return this.connectionState()===He.Open}remove(e){this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}channel(e,t={}){const{selfBroadcast:n}=t,s=Ro(t,["selfBroadcast"]);n&&(s.self_broadcast=n);const i=this.versionDate?new Ft(e,s,this):new vn(e,s,this);return i instanceof Ft&&(i.presence.onJoin((o,a,c)=>{i.trigger("presence",{event:"JOIN",key:o,currentPresences:a,newPresences:c})}),i.presence.onLeave((o,a,c)=>{i.trigger("presence",{event:"LEAVE",key:o,currentPresences:a,leftPresences:c})}),i.presence.onSync(()=>{i.trigger("presence",{event:"SYNC"})})),this.channels.push(i),i}push(e){const{topic:t,event:n,payload:s,ref:i}=e;let o=()=>{this.encode(e,a=>{var c;(c=this.conn)===null||c===void 0||c.send(a)})};this.log("push",`${t} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:s,payload:i,ref:o}=t;(o&&o===this.pendingHeartbeatRef||s===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,i),this.channels.filter(a=>a.isMember(n)).forEach(a=>a.trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Oo}))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({user_token:e}),t.joinedOnce&&t.isJoined()&&t.push(Z.access_token,{access_token:e})})}leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n.isJoined()||n.isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_onConnOpen(){this.log("transport",`connected to ${this.endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e.trigger(Z.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(!!this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(So,"hearbeat timeout");return}this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class jo{constructor(e,t,n,s){const i={},o=s==="*"?`realtime:${n}`:`realtime:${n}:${s}`,a=t.Authorization.split(" ")[1];a&&(i.user_token=a),this.subscription=e.channel(o,i)}getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=hr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=hr(e.columns,e.old_record)),t}on(e,t){return this.subscription.on(e,n=>{let s={schema:n.schema,table:n.table,commit_timestamp:n.commit_timestamp,eventType:n.type,new:{},old:{},errors:n.errors};s=Object.assign(Object.assign({},s),this.getPayloadRecords(n)),t(s)}),this}subscribe(e=()=>{}){return this.subscription.onError(t=>e("SUBSCRIPTION_ERROR",t)),this.subscription.onClose(()=>e("CLOSED")),this.subscription.subscribe().receive("ok",()=>e("SUBSCRIBED")).receive("error",t=>e("SUBSCRIPTION_ERROR",t)).receive("timeout",()=>e("RETRYING_AFTER_TIMEOUT")),this.subscription}}class Po extends ls{constructor(e,{headers:t={},schema:n,realtime:s,table:i,fetch:o,shouldThrowOnError:a}){super(e,{headers:t,schema:n,fetch:o,shouldThrowOnError:a}),this._subscription=null,this._realtime=s,this._headers=t,this._schema=n,this._table=i}on(e,t){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new jo(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(e,t)}}const xo="0.0.0",No={"X-Client-Info":`storage-js/${xo}`};var Tt=globalThis&&globalThis.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})};const Lo=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Mo=(r,e)=>{if(typeof r.json!="function")return e(r);r.json().then(t=>e({message:Lo(t),status:(r==null?void 0:r.status)||500}))},Uo=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};function Qt(r,e,t,n,s,i){return Tt(this,void 0,void 0,function*(){return new Promise((o,a)=>{r(t,Uo(e,n,s,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?o(c):c.json()}).then(c=>o(c)).catch(c=>Mo(c,a))})})}function yn(r,e,t,n){return Tt(this,void 0,void 0,function*(){return Qt(r,"GET",e,t,n)})}function Ge(r,e,t,n,s){return Tt(this,void 0,void 0,function*(){return Qt(r,"POST",e,n,s,t)})}function Bo(r,e,t,n,s){return Tt(this,void 0,void 0,function*(){return Qt(r,"PUT",e,n,s,t)})}function ds(r,e,t,n,s){return Tt(this,void 0,void 0,function*(){return Qt(r,"DELETE",e,n,s,t)})}const fs=r=>{let e;return r?e=r:typeof fetch=="undefined"?e=Xt:e=fetch,(...t)=>e(...t)};var Ze=globalThis&&globalThis.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})};class Fo{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},No),t),this.fetch=fs(n)}listBuckets(){return Ze(this,void 0,void 0,function*(){try{return{data:yield yn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}getBucket(e){return Ze(this,void 0,void 0,function*(){try{return{data:yield yn(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}createBucket(e,t={public:!1}){return Ze(this,void 0,void 0,function*(){try{return{data:(yield Ge(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public},{headers:this.headers})).name,error:null}}catch(n){return{data:null,error:n}}})}updateBucket(e,t){return Ze(this,void 0,void 0,function*(){try{return{data:yield Bo(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public},{headers:this.headers}),error:null}}catch(n){return{data:null,error:n}}})}emptyBucket(e){return Ze(this,void 0,void 0,function*(){try{return{data:yield Ge(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}deleteBucket(e){return Ze(this,void 0,void 0,function*(){try{return{data:yield ds(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}}var we=globalThis&&globalThis.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})};const Ho={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Go={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class zo{constructor(e,t={},n,s){this.url=e,this.headers=t,this.bucketId=n,this.fetch=fs(s)}uploadOrUpdate(e,t,n,s){return we(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Go),s),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob!="undefined"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl)):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),l=yield this.fetch(`${this.url}/object/${u}`,{method:e,body:i,headers:a});if(l.ok)return{data:{Key:u},error:null};{const h=yield l.json();return{data:null,error:h}}}catch(i){return{data:null,error:i}}})}upload(e,t,n){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}update(e,t,n){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t){return we(this,void 0,void 0,function*(){try{return{data:yield Ge(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(n){return{data:null,error:n}}})}copy(e,t){return we(this,void 0,void 0,function*(){try{return{data:yield Ge(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(n){return{data:null,error:n}}})}createSignedUrl(e,t){return we(this,void 0,void 0,function*(){try{const n=this._getFinalPath(e);let s=yield Ge(this.fetch,`${this.url}/object/sign/${n}`,{expiresIn:t},{headers:this.headers});const i=`${this.url}${s.signedURL}`;return s={signedURL:i},{data:s,error:null,signedURL:i}}catch(n){return{data:null,error:n,signedURL:null}}})}createSignedUrls(e,t){return we(this,void 0,void 0,function*(){try{return{data:(yield Ge(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers})).map(s=>Object.assign(Object.assign({},s),{signedURL:s.signedURL?`${this.url}${s.signedURL}`:null})),error:null}}catch(n){return{data:null,error:n}}})}download(e){return we(this,void 0,void 0,function*(){try{const t=this._getFinalPath(e);return{data:yield(yield yn(this.fetch,`${this.url}/object/${t}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(t){return{data:null,error:t}}})}getPublicUrl(e){try{const t=this._getFinalPath(e),n=`${this.url}/object/public/${t}`;return{data:{publicURL:n},error:null,publicURL:n}}catch(t){return{data:null,error:t,publicURL:null}}}remove(e){return we(this,void 0,void 0,function*(){try{return{data:yield ds(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}list(e,t,n){return we(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Ho),t),{prefix:e||""});return{data:yield Ge(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){return{data:null,error:s}}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}class qo extends Fo{constructor(e,t={},n){super(e,t,n)}from(e){return new zo(this.url,this.headers,e,this.fetch)}}const Wo=r=>{let e;return r?e=r:typeof fetch=="undefined"?e=Xt:e=fetch,(...t)=>e(...t)};var Jo=globalThis&&globalThis.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})};class Zo{constructor(e,{headers:t={},customFetch:n}={}){this.url=e,this.headers=t,this.fetch=Wo(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t){return Jo(this,void 0,void 0,function*(){try{const{headers:n,body:s}=t!=null?t:{},i=yield this.fetch(`${this.url}/${e}`,{method:"POST",headers:Object.assign({},this.headers,n),body:s}),o=i.headers.get("x-relay-error");if(o&&o==="true")return{data:null,error:new Error(yield i.text())};let a;const{responseType:c}=t!=null?t:{};return!c||c==="json"?a=yield i.json():c==="arrayBuffer"?a=yield i.arrayBuffer():c==="blob"?a=yield i.blob():a=yield i.text(),{data:a,error:null}}catch(n){return{data:null,error:n}}})}}var Ct=globalThis&&globalThis.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})};const Yo={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:os};class Vo{constructor(e,t,n){if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const s=ki(e),i=Object.assign(Object.assign({},Yo),n);if(this.restUrl=`${s}/rest/v1`,this.realtimeUrl=`${s}/realtime/v1`.replace("http","ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,s.match(/(supabase\.co)|(supabase\.in)/)){const a=s.split(".");this.functionsUrl=`${a[0]}.functions.${a[1]}.${a[2]}`}else this.functionsUrl=`${s}/functions/v1`;this.schema=i.schema,this.multiTab=i.multiTab,this.fetch=i.fetch,this.headers=Object.assign(Object.assign({},os),n==null?void 0:n.headers),this.shouldThrowOnError=i.shouldThrowOnError||!1,this.auth=this._initSupabaseAuthClient(i),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},i.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}get functions(){return new Zo(this.functionsUrl,{headers:this._getAuthHeaders(),customFetch:this.fetch})}get storage(){return new qo(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(e){const t=`${this.restUrl}/${e}`;return new Po(t,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:e,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:n=!1,count:s=null}={}){return this._initPostgRESTClient().rpc(e,t,{head:n,count:s})}channel(e,t){var n,s;const i=(s=(n=this.auth.session())===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:this.supabaseKey;return this.realtime.isConnected()||this.realtime.connect(),this.realtime.channel(e,Object.assign(Object.assign({},t),{user_token:i}))}removeAllSubscriptions(){return Ct(this,void 0,void 0,function*(){const e=this.getSubscriptions().slice(),t=e.map(s=>this.removeSubscription(s));return(yield Promise.all(t)).map(({error:s},i)=>({data:{subscription:e[i]},error:s}))})}removeChannel(e){return Ct(this,void 0,void 0,function*(){const{error:t}=yield this._closeSubscription(e),n=this.getSubscriptions(),s=n.filter(i=>i.isJoined()).length;return n.length===0&&(yield this.realtime.disconnect()),{data:{openChannels:s},error:t}})}removeSubscription(e){return Ct(this,void 0,void 0,function*(){const{error:t}=yield this._closeSubscription(e),n=this.getSubscriptions(),s=n.filter(i=>i.isJoined()).length;return n.length===0&&(yield this.realtime.disconnect()),{data:{openSubscriptions:s},error:t}})}_closeSubscription(e){return Ct(this,void 0,void 0,function*(){let t=null;if(!e.isClosed()){const{error:n}=yield this._unsubscribeSubscription(e);t=n}return this.realtime.remove(e),{error:t}})}_unsubscribeSubscription(e){return new Promise(t=>{e.unsubscribe().receive("ok",()=>t({error:null})).receive("error",n=>t({error:n})).receive("timeout",()=>t({error:new Error("timed out")}))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,localStorage:s,headers:i,fetch:o,cookieOptions:a,multiTab:c}){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new zi({url:this.authUrl,headers:Object.assign(Object.assign({},i),u),autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,localStorage:s,fetch:o,cookieOptions:a,multiTab:c})}_initRealtimeClient(e){return new Co(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign(Object.assign({},e==null?void 0:e.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new Yi(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch,throwOnError:this.shouldThrowOnError})}_getAuthHeaders(){var e,t;const n=Object.assign({},this.headers),s=(t=(e=this.auth.session())===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey;return n.apikey=this.supabaseKey,n.Authorization=n.Authorization||`Bearer ${s}`,n}_listenForMultiTabEvents(){if(!this.multiTab||!$i()||!(window!=null&&window.addEventListener))return null;try{return window==null?void 0:window.addEventListener("storage",e=>{var t,n,s;if(e.key===Ti){const i=JSON.parse(String(e.newValue)),o=(n=(t=i==null?void 0:i.currentSession)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:void 0,a=(s=this.auth.session())===null||s===void 0?void 0:s.access_token;o?!a&&o?this._handleTokenChanged("SIGNED_IN",o,"STORAGE"):a!==o&&this._handleTokenChanged("TOKEN_REFRESHED",o,"STORAGE"):this._handleTokenChanged("SIGNED_OUT",o,"STORAGE")}})}catch(e){return console.error("_listenForMultiTabEvents",e),null}}_listenForAuthEvents(){let{data:e}=this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,n==null?void 0:n.access_token,"CLIENT")});return e}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t),n=="STORAGE"&&this.auth.setAuth(t),this.changedAccessToken=t):(e==="SIGNED_OUT"||e==="USER_DELETED")&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut())}}const Ko=(r,e,t)=>new Vo(r,e,t),ce=Ko("https://vqqkvbscnfidkpafvkel.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZxcWt2YnNjbmZpZGtwYWZ2a2VsIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NjI5MDQxMTcsImV4cCI6MTk3ODQ4MDExN30.5SVXDPEgPiOpRs0g4P6YeangfYwuogthRfAzpUpSSLs"),bn=Pn(ce.auth.user());ce.auth.onAuthStateChange((r,e)=>{r=="SIGNED_IN"?bn.set(e.user):r=="SIGNED_OUT"&&bn.set(null)});var he={get user(){return bn},signIn(r){return ce.auth.signIn({email:r})},signOut(){return ce.auth.signOut()},boards:{async all(){const{body:r}=await ce.from("boards").select("*").order("position");return r},async get(r){const{body:e}=await ce.from("boards").select("id, title, lists ( id, title, position, cards ( id, description, position ))").eq("id",r).order("position").order("position",{foreignTable:"lists"}).order("position",{foreignTable:"lists.cards"}).single();return e},async create(r){const{body:e}=await ce.from("boards").insert(r);return e[0]},async update(r){const{body:e}=await ce.from("boards").update({title:r.title}).match({id:r.id});return e[0]},async sort(r){const{body:e}=await ce.rpc("sort_board",{board_id:r.id,list_ids:r.lists.map(t=>t.id)});return e}},lists:{async create(r,e){const{body:t}=await ce.from("lists").insert(Se({board_id:r.id},e)),n=t[0];return Dt(Se({},n),{cards:[]})},async update(r){const{body:e}=await ce.from("lists").update({title:r.title}).match({id:r.id});return e[0]},async sort(r){const{body:e}=await ce.rpc("sort_list",{new_list_id:r.id,card_ids:r.cards.map(t=>t.id)});return e}},cards:{async create(r,e){const{body:t}=await ce.from("cards").insert(Se({list_id:r.id},e));return t[0]},async update(r){const{body:e}=await ce.from("cards").update({description:r.description}).match({id:r.id});return e[0]}}};const Xo="finalize",Qo="consider";function st(r,e,t){r.dispatchEvent(new CustomEvent(Xo,{detail:{items:e,info:t}}))}function Me(r,e,t){r.dispatchEvent(new CustomEvent(Qo,{detail:{items:e,info:t}}))}const en="draggedEntered",kt="draggedLeft",tn="draggedOverIndex",Bn="draggedLeftDocument",Ht={LEFT_FOR_ANOTHER:"leftForAnother",OUTSIDE_OF_ANY:"outsideOfAny"};function ea(r,e,t){r.dispatchEvent(new CustomEvent(en,{detail:{indexObj:e,draggedEl:t}}))}function ta(r,e,t){r.dispatchEvent(new CustomEvent(kt,{detail:{draggedEl:e,type:Ht.LEFT_FOR_ANOTHER,theOtherDz:t}}))}function na(r,e){r.dispatchEvent(new CustomEvent(kt,{detail:{draggedEl:e,type:Ht.OUTSIDE_OF_ANY}}))}function ra(r,e,t){r.dispatchEvent(new CustomEvent(tn,{detail:{indexObj:e,draggedEl:t}}))}function sa(r){window.dispatchEvent(new CustomEvent(Bn,{detail:{draggedEl:r}}))}const ae={DRAG_STARTED:"dragStarted",DRAGGED_ENTERED:en,DRAGGED_ENTERED_ANOTHER:"dragEnteredAnother",DRAGGED_OVER_INDEX:tn,DRAGGED_LEFT:kt,DRAGGED_LEFT_ALL:"draggedLeftAll",DROPPED_INTO_ZONE:"droppedIntoZone",DROPPED_INTO_ANOTHER:"droppedIntoAnother",DROPPED_OUTSIDE_OF_ANY:"droppedOutsideOfAny",DRAG_STOPPED:"dragStopped"},ue={POINTER:"pointer",KEYBOARD:"keyboard"},Te="isDndShadowItem",Fn="data-is-dnd-shadow-item",Hn="id:dnd-shadow-placeholder-0000";let V="id",wn=0;function ps(){wn++}function ms(){if(wn===0)throw new Error("Bug! trying to decrement when there are no dropzones");wn--}const ia=typeof window=="undefined";function gs(r){let e;const t=r.getBoundingClientRect(),n=getComputedStyle(r),s=n.transform;if(s){let i,o,a,c;if(s.startsWith("matrix3d("))e=s.slice(9,-1).split(/, /),i=+e[0],o=+e[5],a=+e[12],c=+e[13];else if(s.startsWith("matrix("))e=s.slice(7,-1).split(/, /),i=+e[0],o=+e[3],a=+e[4],c=+e[5];else return t;const u=n.transformOrigin,l=t.x-a-(1-i)*parseFloat(u),h=t.y-c-(1-o)*parseFloat(u.slice(u.indexOf(" ")+1)),f=i?t.width/i:r.offsetWidth,g=o?t.height/o:r.offsetHeight;return{x:l,y:h,width:f,height:g,top:h,right:l+f,bottom:h+g,left:l}}else return t}function _s(r){const e=gs(r);return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function Gn(r){const e=r.getBoundingClientRect();return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function oa(r){return{x:(r.left+r.right)/2,y:(r.top+r.bottom)/2}}function aa(r,e){return Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2))}function zn(r,e){return r.y<=e.bottom&&r.y>=e.top&&r.x>=e.left&&r.x<=e.right}function yt(r){return oa(Gn(r))}function dr(r,e){const t=yt(r),n=_s(e);return zn(t,n)}function la(r,e){const t=yt(r),n=yt(e);return aa(t,n)}function ca(r){const e=Gn(r);return e.right<0||e.left>document.documentElement.scrollWidth||e.bottom<0||e.top>document.documentElement.scrollHeight}function ua(r,e){const t=Gn(e);return zn(r,t)?{top:r.y-t.top,bottom:t.bottom-r.y,left:r.x-t.left,right:Math.min(t.right,document.documentElement.clientWidth)-r.x}:null}let et;function vs(){et=new Map}vs();function ha(r){const e=Array.from(r.children).findIndex(t=>t.getAttribute(Fn));if(e>=0)return et.has(r)||et.set(r,new Map),et.get(r).set(e,_s(r.children[e])),e}function da(r,e){if(!dr(r,e))return null;const t=e.children;if(t.length===0)return{index:0,isProximityBased:!0};const n=ha(e);for(let o=0;o<t.length;o++)if(dr(r,t[o])){const a=et.has(e)&&et.get(e).get(o);return a&&!zn(yt(r),a)?{index:n,isProximityBased:!1}:{index:o,isProximityBased:!1}}let s=Number.MAX_VALUE,i;for(let o=0;o<t.length;o++){const a=la(r,t[o]);a<s&&(s=a,i=o)}return{index:i,isProximityBased:!0}}const ht=25;function ys(){let r;function e(){r={directionObj:void 0,stepPx:0}}e();function t(i){const{directionObj:o,stepPx:a}=r;o&&(i.scrollBy(o.x*a,o.y*a),window.requestAnimationFrame(()=>t(i)))}function n(i){return ht-i}function s(i,o){if(!o)return!1;const a=ua(i,o);if(a===null)return e(),!1;const c=!!r.directionObj;let[u,l]=[!1,!1];return o.scrollHeight>o.clientHeight&&(a.bottom<ht?(u=!0,r.directionObj={x:0,y:1},r.stepPx=n(a.bottom)):a.top<ht&&(u=!0,r.directionObj={x:0,y:-1},r.stepPx=n(a.top)),!c&&u)||o.scrollWidth>o.clientWidth&&(a.right<ht?(l=!0,r.directionObj={x:1,y:0},r.stepPx=n(a.right)):a.left<ht&&(l=!0,r.directionObj={x:-1,y:0},r.stepPx=n(a.left)),!c&&l)?(t(o),!0):(e(),!1)}return{scrollIfNeeded:s,resetScrolling:e}}function fr(r){return JSON.stringify(r,null,2)}function pr(r){if(!r)throw new Error("cannot get depth of a falsy node");return bs(r,0)}function bs(r,e=0){return r.parentElement?bs(r.parentElement,e+1):e-1}function fa(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const t in r)if(!{}.hasOwnProperty.call(e,t)||e[t]!==r[t])return!1;return!0}function pa(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}const ma=200,mr=10,{scrollIfNeeded:ga,resetScrolling:_a}=ys();let En;function va(r,e,t=ma){let n,s,i=!1,o;const a=Array.from(e).sort((u,l)=>pr(l)-pr(u));function c(){const u=yt(r);if(!ga(u,n)&&o&&Math.abs(o.x-u.x)<mr&&Math.abs(o.y-u.y)<mr){En=window.setTimeout(c,t);return}if(ca(r)){sa(r);return}o=u;let h=!1;for(const f of a){const g=da(r,f);if(g===null)continue;const{index:m}=g;h=!0,f!==n?(n&&ta(n,r,f),ea(f,g,r),n=f):m!==s&&(ra(f,g,r),s=m);break}!h&&i&&n?(na(n,r),n=void 0,s=void 0,i=!1):i=!0,En=window.setTimeout(c,t)}c()}function ya(){clearTimeout(En),_a(),vs()}const ba=300;let Gt;function zt(r){const e=r.touches?r.touches[0]:r;Gt={x:e.clientX,y:e.clientY}}const{scrollIfNeeded:wa,resetScrolling:Ea}=ys();let ws;function Es(){Gt&&wa(Gt,document.documentElement),ws=window.setTimeout(Es,ba)}function Ta(){window.addEventListener("mousemove",zt),window.addEventListener("touchmove",zt),Es()}function ka(){window.removeEventListener("mousemove",zt),window.removeEventListener("touchmove",zt),Gt=void 0,window.clearTimeout(ws),Ea()}const $a=.2;function Ue(r){return`${r} ${$a}s ease`}function Oa(r){const e=r.getBoundingClientRect(),t=r.cloneNode(!0);return Ts(r,t),t.id="dnd-action-dragged-el",t.style.position="fixed",t.style.top=`${e.top}px`,t.style.left=`${e.left}px`,t.style.margin="0",t.style.boxSizing="border-box",t.style.height=`${e.height}px`,t.style.width=`${e.width}px`,t.style.transition=`${Ue("width")}, ${Ue("height")}, ${Ue("background-color")}, ${Ue("opacity")}, ${Ue("color")} `,window.setTimeout(()=>t.style.transition+=`, ${Ue("top")}, ${Ue("left")}`,0),t.style.zIndex="9999",t.style.cursor="grabbing",t}function Sa(r){r.style.cursor="grab"}function Da(r,e,t,n,s){const i=e.getBoundingClientRect(),o=r.getBoundingClientRect(),a=i.width-o.width,c=i.height-o.height;if(a||c){const u={left:(t-o.left)/o.width,top:(n-o.top)/o.height};r.style.height=`${i.height}px`,r.style.width=`${i.width}px`,r.style.left=`${parseFloat(r.style.left)-u.left*a}px`,r.style.top=`${parseFloat(r.style.top)-u.top*c}px`}Ts(e,r),s()}function Ts(r,e){const t=window.getComputedStyle(r);Array.from(t).filter(n=>n.startsWith("background")||n.startsWith("padding")||n.startsWith("font")||n.startsWith("text")||n.startsWith("align")||n.startsWith("justify")||n.startsWith("display")||n.startsWith("flex")||n.startsWith("border")||n==="opacity"||n==="color"||n==="list-style-type").forEach(n=>e.style.setProperty(n,t.getPropertyValue(n),t.getPropertyPriority(n)))}function Aa(r,e){r.draggable=!1,r.ondragstart=()=>!1,e?(r.style.userSelect="",r.style.WebkitUserSelect="",r.style.cursor=""):(r.style.userSelect="none",r.style.WebkitUserSelect="none",r.style.cursor="grab")}function Ra(r){r.style.display="none",r.style.position="fixed",r.style.zIndex="-5"}function Ia(r){r.style.visibility="hidden",r.setAttribute(Fn,"true")}function Ca(r){r.style.visibility="",r.removeAttribute(Fn)}function Nt(r,e=()=>{},t=()=>[]){r.forEach(n=>{const s=e(n);Object.keys(s).forEach(i=>{n.style[i]=s[i]}),t(n).forEach(i=>n.classList.add(i))})}function qt(r,e=()=>{},t=()=>[]){r.forEach(n=>{const s=e(n);Object.keys(s).forEach(i=>{n.style[i]=""}),t(n).forEach(i=>n.classList.contains(i)&&n.classList.remove(i))})}function ja(r){const e=r.style.minHeight;r.style.minHeight=window.getComputedStyle(r).getPropertyValue("height");const t=r.style.minWidth;return r.style.minWidth=window.getComputedStyle(r).getPropertyValue("width"),function(){r.style.minHeight=e,r.style.minWidth=t}}const Pa="--any--",xa=100,gr=3,_r={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let Ae,te,de,nn,J,rn,it,pe,xe,ge,ft=!1,qn=!1,Wn,$t=!1;const ye=new Map,W=new Map,cn=new WeakMap;function Na(r,e){ye.has(e)||ye.set(e,new Set),ye.get(e).has(r)||(ye.get(e).add(r),ps())}function vr(r,e){ye.get(e).delete(r),ms(),ye.get(e).size===0&&ye.delete(e)}function La(){Ta();const r=ye.get(nn);for(const t of r)t.addEventListener(en,ks),t.addEventListener(kt,$s),t.addEventListener(tn,Os);window.addEventListener(Bn,ot);const e=Math.max(xa,...Array.from(r.keys()).map(t=>W.get(t).dropAnimationDurationMs));va(te,r,e*1.07)}function Ma(){ka();const r=ye.get(nn);for(const e of r)e.removeEventListener(en,ks),e.removeEventListener(kt,$s),e.removeEventListener(tn,Os);window.removeEventListener(Bn,ot),ya()}function Ua(r){return r.findIndex(e=>e[V]===Hn)}function sn(r){return r.findIndex(e=>!!e[Te]&&e[V]!==Hn)}function ks(r){let{items:e,dropFromOthersDisabled:t}=W.get(r.currentTarget);if(t&&r.currentTarget!==J)return;if($t=!1,e=e.filter(o=>o[V]!==it[V]),J!==r.currentTarget){const a=W.get(J).items.filter(c=>!c[Te]);Me(J,a,{trigger:ae.DRAGGED_ENTERED_ANOTHER,id:de[V],source:ue.POINTER})}else{const o=Ua(e);o!==-1&&e.splice(o,1)}const{index:n,isProximityBased:s}=r.detail.indexObj,i=s&&n===r.currentTarget.children.length-1?n+1:n;pe=r.currentTarget,e.splice(i,0,it),Me(r.currentTarget,e,{trigger:ae.DRAGGED_ENTERED,id:de[V],source:ue.POINTER})}function $s(r){const{items:e,dropFromOthersDisabled:t}=W.get(r.currentTarget);if(t&&r.currentTarget!==J)return;const n=sn(e),s=e.splice(n,1)[0];pe=void 0;const{type:i,theOtherDz:o}=r.detail;if(i===Ht.OUTSIDE_OF_ANY||i===Ht.LEFT_FOR_ANOTHER&&o!==J&&W.get(o).dropFromOthersDisabled){$t=!0,pe=J;const a=W.get(J).items;a.splice(rn,0,s),Me(J,a,{trigger:ae.DRAGGED_LEFT_ALL,id:de[V],source:ue.POINTER})}Me(r.currentTarget,e,{trigger:ae.DRAGGED_LEFT,id:de[V],source:ue.POINTER})}function Os(r){const{items:e,dropFromOthersDisabled:t}=W.get(r.currentTarget);if(t&&r.currentTarget!==J)return;$t=!1;const{index:n}=r.detail.indexObj,s=sn(e);e.splice(s,1),e.splice(n,0,it),Me(r.currentTarget,e,{trigger:ae.DRAGGED_OVER_INDEX,id:de[V],source:ue.POINTER})}function Wt(r){r.preventDefault();const e=r.touches?r.touches[0]:r;ge={x:e.clientX,y:e.clientY},te.style.transform=`translate3d(${ge.x-xe.x}px, ${ge.y-xe.y}px, 0)`}function ot(){qn=!0,window.removeEventListener("mousemove",Wt),window.removeEventListener("touchmove",Wt),window.removeEventListener("mouseup",ot),window.removeEventListener("touchend",ot),Ma(),Sa(te),pe||(pe=J);let{items:r,type:e}=W.get(pe);qt(ye.get(e),s=>W.get(s).dropTargetStyle,s=>W.get(s).dropTargetClasses);let t=sn(r);t===-1&&(t=rn),r=r.map(s=>s[Te]?de:s);function n(){Wn(),st(pe,r,{trigger:$t?ae.DROPPED_OUTSIDE_OF_ANY:ae.DROPPED_INTO_ZONE,id:de[V],source:ue.POINTER}),pe!==J&&st(J,W.get(J).items,{trigger:ae.DROPPED_INTO_ANOTHER,id:de[V],source:ue.POINTER}),Ca(pe.children[t]),Fa()}Ba(t,n)}function Ba(r,e){const t=gs(pe.children[r]),n={x:t.left-parseFloat(te.style.left),y:t.top-parseFloat(te.style.top)},{dropAnimationDurationMs:s}=W.get(pe),i=`transform ${s}ms ease`;te.style.transition=te.style.transition?te.style.transition+","+i:i,te.style.transform=`translate3d(${n.x}px, ${n.y}px, 0)`,window.setTimeout(e,s)}function Fa(){te.remove(),Ae.remove(),te=void 0,Ae=void 0,de=void 0,nn=void 0,J=void 0,rn=void 0,it=void 0,pe=void 0,xe=void 0,ge=void 0,ft=!1,qn=!1,Wn=void 0,$t=!1}function Ha(r,e){const t={items:void 0,type:void 0,flipDurationMs:0,dragDisabled:!1,dropFromOthersDisabled:!1,dropTargetStyle:_r,dropTargetClasses:[],transformDraggedElement:()=>{}};let n=new Map;function s(){window.addEventListener("mousemove",a,{passive:!1}),window.addEventListener("touchmove",a,{passive:!1,capture:!1}),window.addEventListener("mouseup",o,{passive:!1}),window.addEventListener("touchend",o,{passive:!1})}function i(){window.removeEventListener("mousemove",a),window.removeEventListener("touchmove",a),window.removeEventListener("mouseup",o),window.removeEventListener("touchend",o)}function o(){i(),Ae=void 0,xe=void 0,ge=void 0}function a(h){h.preventDefault();const f=h.touches?h.touches[0]:h;ge={x:f.clientX,y:f.clientY},(Math.abs(ge.x-xe.x)>=gr||Math.abs(ge.y-xe.y)>=gr)&&(i(),u())}function c(h){if(h.target!==h.currentTarget&&(h.target.value!==void 0||h.target.isContentEditable)||h.button||ft)return;h.stopPropagation();const f=h.touches?h.touches[0]:h;xe={x:f.clientX,y:f.clientY},ge=Se({},xe),Ae=h.currentTarget,s()}function u(){ft=!0;const h=n.get(Ae);rn=h,J=Ae.parentElement;const{items:f,type:g}=t;de=Se({},f[h]),nn=g,it=Dt(Se({},de),{[Te]:!0});const m=Dt(Se({},it),{[V]:Hn});te=Oa(Ae);function $(){te.parentElement?window.requestAnimationFrame($):(document.body.appendChild(te),te.focus(),La(),Ra(Ae),document.body.appendChild(Ae))}window.requestAnimationFrame($),Nt(Array.from(ye.get(t.type)).filter(y=>y===J||!W.get(y).dropFromOthersDisabled),y=>W.get(y).dropTargetStyle,y=>W.get(y).dropTargetClasses),f.splice(h,1,m),Wn=ja(J),Me(J,f,{trigger:ae.DRAG_STARTED,id:de[V],source:ue.POINTER}),window.addEventListener("mousemove",Wt,{passive:!1}),window.addEventListener("touchmove",Wt,{passive:!1,capture:!1}),window.addEventListener("mouseup",ot,{passive:!1}),window.addEventListener("touchend",ot,{passive:!1})}function l({items:h=void 0,flipDurationMs:f=0,type:g=Pa,dragDisabled:m=!1,dropFromOthersDisabled:$=!1,dropTargetStyle:y=_r,dropTargetClasses:E=[],transformDraggedElement:O=()=>{}}){t.dropAnimationDurationMs=f,t.type&&g!==t.type&&vr(r,t.type),t.type=g,Na(r,g),t.items=[...h],t.dragDisabled=m,t.transformDraggedElement=O,ft&&!qn&&(!fa(y,t.dropTargetStyle)||!pa(E,t.dropTargetClasses))&&(qt([r],()=>t.dropTargetStyle,()=>E),Nt([r],()=>y,()=>E)),t.dropTargetStyle=y,t.dropTargetClasses=[...E],ft&&t.dropFromOthersDisabled!==$&&($?qt([r],B=>W.get(B).dropTargetStyle,B=>W.get(B).dropTargetClasses):Nt([r],B=>W.get(B).dropTargetStyle,B=>W.get(B).dropTargetClasses)),t.dropFromOthersDisabled=$,W.set(r,t);const L=sn(t.items);for(let B=0;B<r.children.length;B++){const _=r.children[B];if(Aa(_,m),B===L){Da(te,_,ge.x,ge.y,()=>t.transformDraggedElement(te,de,B)),Ia(_);continue}_.removeEventListener("mousedown",cn.get(_)),_.removeEventListener("touchstart",cn.get(_)),m||(_.addEventListener("mousedown",c),_.addEventListener("touchstart",c),cn.set(_,c)),n.set(_,B)}}return l(e),{update:h=>{l(h)},destroy:()=>{vr(r,t.type),W.delete(r)}}}const Tn={DND_ZONE_ACTIVE:"dnd-zone-active",DND_ZONE_DRAG_DISABLED:"dnd-zone-drag-disabled"},Ga={[Tn.DND_ZONE_ACTIVE]:"Tab to one the items and press space-bar or enter to start dragging it",[Tn.DND_ZONE_DRAG_DISABLED]:"This is a disabled drag and drop list"},za="dnd-action-aria-alert";let oe;function yr(){oe=document.createElement("div"),function(){oe.id=za,oe.style.position="fixed",oe.style.bottom="0",oe.style.left="0",oe.style.zIndex="-5",oe.style.opacity="0",oe.style.height="0",oe.style.width="0",oe.setAttribute("role","alert")}(),document.body.prepend(oe),Object.entries(Ga).forEach(([r,e])=>document.body.prepend(Wa(r,e)))}function qa(){return ia?null:(document.readyState==="complete"?yr():window.addEventListener("DOMContentLoaded",yr),Se({},Tn))}function Wa(r,e){const t=document.createElement("div");return t.id=r,t.innerHTML=`<p>${e}</p>`,t.style.display="none",t.style.position="fixed",t.style.zIndex="-5",t}function tt(r){oe.innerHTML="";const e=document.createTextNode(r);oe.appendChild(e),oe.style.display="none",oe.style.display="inline"}const Ja="--any--",br={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let fe=!1,kn,se,qe="",Be,Ee,Ne="";const Jt=new WeakSet,wr=new WeakMap,Er=new WeakMap,$n=new Map,ee=new Map,ve=new Map,Tr=qa();function Za(r,e){ve.size===0&&(window.addEventListener("keydown",Ss),window.addEventListener("click",Ds)),ve.has(e)||ve.set(e,new Set),ve.get(e).has(r)||(ve.get(e).add(r),ps())}function kr(r,e){se===r&&bt(),ve.get(e).delete(r),ms(),ve.get(e).size===0&&ve.delete(e),ve.size===0&&(window.removeEventListener("keydown",Ss),window.removeEventListener("click",Ds))}function Ss(r){if(!!fe)switch(r.key){case"Escape":{bt();break}}}function Ds(){!fe||Jt.has(document.activeElement)||bt()}function Ya(r){if(!fe)return;const e=r.currentTarget;if(e===se)return;qe=e.getAttribute("aria-label")||"";const{items:t}=ee.get(se),n=t.find(u=>u[V]===Ee),s=t.indexOf(n),i=t.splice(s,1)[0],{items:o,autoAriaDisabled:a}=ee.get(e);e.getBoundingClientRect().top<se.getBoundingClientRect().top||e.getBoundingClientRect().left<se.getBoundingClientRect().left?(o.push(i),a||tt(`Moved item ${Ne} to the end of the list ${qe}`)):(o.unshift(i),a||tt(`Moved item ${Ne} to the beginning of the list ${qe}`)),st(se,t,{trigger:ae.DROPPED_INTO_ANOTHER,id:Ee,source:ue.KEYBOARD}),st(e,o,{trigger:ae.DROPPED_INTO_ZONE,id:Ee,source:ue.KEYBOARD}),se=e}function As(){$n.forEach(({update:r},e)=>r(ee.get(e)))}function bt(r=!0){ee.get(se).autoAriaDisabled||tt(`Stopped dragging item ${Ne}`),Jt.has(document.activeElement)&&document.activeElement.blur(),r&&Me(se,ee.get(se).items,{trigger:ae.DRAG_STOPPED,id:Ee,source:ue.KEYBOARD}),qt(ve.get(kn),e=>ee.get(e).dropTargetStyle,e=>ee.get(e).dropTargetClasses),Be=null,Ee=null,Ne="",kn=null,se=null,qe="",fe=!1,As()}function Va(r,e){const t={items:void 0,type:void 0,dragDisabled:!1,dropFromOthersDisabled:!1,dropTargetStyle:br,dropTargetClasses:[],autoAriaDisabled:!1};function n(l,h,f){l.length<=1||l.splice(f,1,l.splice(h,1,l[f])[0])}function s(l){switch(l.key){case"Enter":case" ":{if((l.target.disabled!==void 0||l.target.href||l.target.isContentEditable)&&!Jt.has(l.target))return;l.preventDefault(),l.stopPropagation(),fe?bt():i(l);break}case"ArrowDown":case"ArrowRight":{if(!fe)return;l.preventDefault(),l.stopPropagation();const{items:h}=ee.get(r),f=Array.from(r.children),g=f.indexOf(l.currentTarget);g<f.length-1&&(t.autoAriaDisabled||tt(`Moved item ${Ne} to position ${g+2} in the list ${qe}`),n(h,g,g+1),st(r,h,{trigger:ae.DROPPED_INTO_ZONE,id:Ee,source:ue.KEYBOARD}));break}case"ArrowUp":case"ArrowLeft":{if(!fe)return;l.preventDefault(),l.stopPropagation();const{items:h}=ee.get(r),g=Array.from(r.children).indexOf(l.currentTarget);g>0&&(t.autoAriaDisabled||tt(`Moved item ${Ne} to position ${g} in the list ${qe}`),n(h,g,g-1),st(r,h,{trigger:ae.DROPPED_INTO_ZONE,id:Ee,source:ue.KEYBOARD}));break}}}function i(l){a(l.currentTarget),se=r,kn=t.type,fe=!0;const h=Array.from(ve.get(t.type)).filter(f=>f===se||!ee.get(f).dropFromOthersDisabled);if(Nt(h,f=>ee.get(f).dropTargetStyle,f=>ee.get(f).dropTargetClasses),!t.autoAriaDisabled){let f=`Started dragging item ${Ne}. Use the arrow keys to move it within its list ${qe}`;h.length>1&&(f+=", or tab to another list in order to move the item into it"),tt(f)}Me(r,ee.get(r).items,{trigger:ae.DRAG_STARTED,id:Ee,source:ue.KEYBOARD}),As()}function o(l){!fe||l.currentTarget!==Be&&(l.stopPropagation(),bt(!1),i(l))}function a(l){const{items:h}=ee.get(r),f=Array.from(r.children),g=f.indexOf(l);Be=l,Be.tabIndex=0,Ee=h[g][V],Ne=f[g].getAttribute("aria-label")||""}function c({items:l=[],type:h=Ja,dragDisabled:f=!1,dropFromOthersDisabled:g=!1,dropTargetStyle:m=br,dropTargetClasses:$=[],autoAriaDisabled:y=!1}){t.items=[...l],t.dragDisabled=f,t.dropFromOthersDisabled=g,t.dropTargetStyle=m,t.dropTargetClasses=$,t.autoAriaDisabled=y,y||(r.setAttribute("aria-disabled",f),r.setAttribute("role","list"),r.setAttribute("aria-describedby",f?Tr.DND_ZONE_DRAG_DISABLED:Tr.DND_ZONE_ACTIVE)),t.type&&h!==t.type&&kr(r,t.type),t.type=h,Za(r,h),ee.set(r,t),r.tabIndex=fe&&(r===se||Be.contains(r)||t.dropFromOthersDisabled||se&&t.type!==ee.get(se).type)?-1:0,r.addEventListener("focus",Ya);for(let E=0;E<r.children.length;E++){const O=r.children[E];Jt.add(O),O.tabIndex=fe?-1:0,y||O.setAttribute("role","listitem"),O.removeEventListener("keydown",wr.get(O)),O.removeEventListener("click",Er.get(O)),f||(O.addEventListener("keydown",s),wr.set(O,s),O.addEventListener("click",o),Er.set(O,o)),fe&&t.items[E][V]===Ee&&(Be=O,Be.tabIndex=0,O.focus())}}c(e);const u={update:l=>{c(l)},destroy:()=>{kr(r,t.type),ee.delete(r),$n.delete(r)}};return $n.set(r,u),u}function Rs(r,e){$r(e);const t=Ha(r,e),n=Va(r,e);return{update:s=>{$r(s),t.update(s),n.update(s)},destroy:()=>{t.destroy(),n.destroy()}}}function $r(r){const f=r,{items:e,flipDurationMs:t,type:n,dragDisabled:s,dropFromOthersDisabled:i,dropTargetStyle:o,dropTargetClasses:a,transformDraggedElement:c,autoAriaDisabled:u}=f,l=Xn(f,["items","flipDurationMs","type","dragDisabled","dropFromOthersDisabled","dropTargetStyle","dropTargetClasses","transformDraggedElement","autoAriaDisabled"]);if(Object.keys(l).length>0&&console.warn("dndzone will ignore unknown options",l),!e)throw new Error("no 'items' key provided to dndzone");const h=e.find(g=>!{}.hasOwnProperty.call(g,V));if(h)throw new Error(`missing '${V}' property for item ${fr(h)}`);if(a&&!Array.isArray(a))throw new Error(`dropTargetClasses should be an array but instead it is a ${typeof a}, ${fr(a)}`)}function Is(r){return r*r*r}function Cs(r){const e=r-1;return e*e*e+1}function Jn(r,{delay:e=0,duration:t=400,easing:n=Sn}={}){const s=+getComputedStyle(r).opacity;return{delay:e,duration:t,easing:n,css:i=>`opacity: ${i*s}`}}function Ka(r,{delay:e=0,duration:t=400,easing:n=Cs,x:s=0,y:i=0,opacity:o=0}={}){const a=getComputedStyle(r),c=+a.opacity,u=a.transform==="none"?"":a.transform,l=c*(1-o);return{delay:e,duration:t,easing:n,css:(h,f)=>`
			transform: ${u} translate(${(1-h)*s}px, ${(1-h)*i}px);
			opacity: ${c-l*f}`}}function Xa(r,{from:e,to:t},n={}){const s=getComputedStyle(r),i=s.transform==="none"?"":s.transform,[o,a]=s.transformOrigin.split(" ").map(parseFloat),c=e.left+e.width*o/t.width-(t.left+o),u=e.top+e.height*a/t.height-(t.top+a),{delay:l=0,duration:h=g=>Math.sqrt(g)*120,easing:f=Cs}=n;return{delay:l,duration:at(h)?h(Math.sqrt(c*c+u*u)):h,easing:f,css:(g,m)=>{const $=m*c,y=m*u,E=g+m*e.width/t.width,O=g+m*e.height/t.height;return`transform: ${i} translate(${$}px, ${y}px) scale(${E}, ${O});`}}}function Qa(r){let e,t,n,s;return{c(){e=I("div"),t=me(r[0]),k(e,"class","svelte-1fcif2w")},m(i,o){N(i,e,o),D(e,t),n||(s=Y(e,"click",r[2]),n=!0)},p(i,o){o&1&&We(t,i[0])},d(i){i&&x(e),n=!1,s()}}}function el(r){let e,t,n,s;return{c(){e=I("form"),t=I("input"),t.required=!0,k(t,"class","svelte-1fcif2w"),k(e,"class","svelte-1fcif2w")},m(i,o){N(i,e,o),D(e,t),nt(t,r[0]),n||(s=[Y(t,"input",r[5]),Y(t,"blur",r[3]),Zt(nl.call(null,t)),Y(e,"submit",An(r[3])),Y(e,"keydown",r[4])],n=!0)},p(i,o){o&1&&t.value!==i[0]&&nt(t,i[0])},d(i){i&&x(e),n=!1,ke(s)}}}function tl(r){let e;function t(i,o){return i[1]?el:Qa}let n=t(r),s=n(r);return{c(){s.c(),e=gt()},m(i,o){s.m(i,o),N(i,e,o)},p(i,[o]){n===(n=t(i))&&s?s.p(i,o):(s.d(1),s=n(i),s&&(s.c(),s.m(e.parentNode,e)))},i:U,o:U,d(i){s.d(i),i&&x(e)}}}function nl(r){r.focus()}function rl(r,e,t){let{value:n}=e;const s=Rn();let i=!1,o;wt(()=>{o=n});function a(){t(1,i=!0)}function c(){n!=o&&s("submit",n),t(1,i=!1)}function u(h){h.key=="Escape"&&(h.preventDefault(),t(0,n=o),t(1,i=!1))}function l(){n=this.value,t(0,n)}return r.$$set=h=>{"value"in h&&t(0,n=h.value)},[n,i,a,c,u,l]}class Zn extends Oe{constructor(e){super(),$e(this,e,rl,tl,be,{value:0})}}function sl(r){let e,t,n,s,i,o,a,c,u,l,h;return{c(){e=I("form"),t=I("input"),n=z(),s=I("div"),i=I("button"),o=me(r[2]),a=z(),c=I("button"),c.innerHTML='<svg height="20" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-1v84vik"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-1v84vik"></path></svg>',k(t,"placeholder",r[1]),t.required=!0,k(t,"class","svelte-1v84vik"),k(i,"class","submit svelte-1v84vik"),k(i,"type","submit"),k(c,"class","close svelte-1v84vik"),k(c,"type","button"),k(s,"class","actions svelte-1v84vik"),k(e,"class",u=tr(r[0])+" svelte-1v84vik")},m(f,g){N(f,e,g),D(e,t),nt(t,r[4]),r[9](t),D(e,n),D(e,s),D(s,i),D(i,o),D(s,a),D(s,c),l||(h=[Y(t,"input",r[8]),Y(t,"keydown",r[7]),Y(c,"click",r[6]),Y(e,"submit",An(r[5]))],l=!0)},p(f,[g]){g&2&&k(t,"placeholder",f[1]),g&16&&t.value!==f[4]&&nt(t,f[4]),g&4&&We(o,f[2]),g&1&&u!==(u=tr(f[0])+" svelte-1v84vik")&&k(e,"class",u)},i:U,o:U,d(f){f&&x(e),r[9](null),l=!1,ke(h)}}}function il(r,e,t){let{class:n}=e,{placeholder:s}=e,{action:i="Add"}=e;const o=Rn();let a,c="";wt(()=>{a.focus()});function u(){o("submit",c),t(4,c="")}function l(){o("close"),t(4,c="")}function h(m){m.key=="Escape"&&(l(),m.preventDefault())}function f(){c=this.value,t(4,c)}function g(m){rt[m?"unshift":"push"](()=>{a=m,t(3,a)})}return r.$$set=m=>{"class"in m&&t(0,n=m.class),"placeholder"in m&&t(1,s=m.placeholder),"action"in m&&t(2,i=m.action)},[n,s,i,a,c,u,l,h,f,g]}class js extends Oe{constructor(e){super(),$e(this,e,il,sl,be,{class:0,placeholder:1,action:2})}}function Or(r,e,t){const n=r.slice();return n[14]=e[t],n[15]=e,n[16]=t,n}function Sr(r){let e,t=r[14].title+"",n,s;return{c(){e=I("div"),n=me(t),k(e,"class","drag-shadow svelte-t5efn8")},m(i,o){N(i,e,o),D(e,n)},p(i,o){r=i,o&1&&t!==(t=r[14].title+"")&&We(n,t)},i(i){s||Le(()=>{s=Vt(e,Jn,{duration:200,easing:Is}),s.start()})},o:U,d(i){i&&x(e)}}}function Dr(r,e){let t,n,s,i,o,a,c,u,l,h=U,f;function g(E){e[12](E,e[14])}function m(...E){return e[13](e[14],...E)}let $={};e[14].description!==void 0&&($.value=e[14].description),s=new Zn({props:$}),rt.push(()=>jn(s,"value",g)),s.$on("submit",m);let y=e[14][Te]&&Sr(e);return{key:r,first:null,c(){t=I("li"),n=I("div"),ne(s.$$.fragment),o=z(),a=I("button"),a.innerHTML='<svg height="14" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-t5efn8"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-t5efn8"></path></svg>',c=z(),y&&y.c(),u=z(),k(n,"class","svelte-t5efn8"),k(a,"class","pen svelte-t5efn8"),k(t,"class","svelte-t5efn8"),this.first=t},m(E,O){N(E,t,O),D(t,n),K(s,n,null),D(t,o),D(t,a),D(t,c),y&&y.m(t,null),D(t,u),f=!0},p(E,O){e=E;const L={};!i&&O&1&&(i=!0,L.value=e[14].description,Cn(()=>i=!1)),s.$set(L),e[14][Te]?y?(y.p(e,O),O&1&&C(y,1)):(y=Sr(e),y.c(),C(y,1),y.m(t,u)):y&&(y.d(1),y=null)},r(){l=t.getBoundingClientRect()},f(){Xs(t),h()},a(){h(),h=Ks(t,l,Xa,{duration:On})},i(E){f||(C(s.$$.fragment,E),C(y),f=!0)},o(E){P(s.$$.fragment,E),f=!1},d(E){E&&x(t),X(s),y&&y.d()}}}function ol(r){let e,t,n,s,i,o=r[0].cards.length==0?"Add a card":"Add another card",a,c,u;return{c(){e=I("button"),t=Lt("svg"),n=Lt("path"),s=z(),i=I("span"),a=me(o),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"stroke-width","2"),k(n,"d","M12 6v6m0 0v6m0-6h6m-6 0H6"),k(n,"class","svelte-t5efn8"),k(t,"height","20"),k(t,"xmlns","http://www.w3.org/2000/svg"),k(t,"fill","none"),k(t,"viewBox","0 0 24 24"),k(t,"stroke","currentColor"),k(t,"class","svelte-t5efn8"),k(i,"class","svelte-t5efn8"),k(e,"class","add svelte-t5efn8")},m(l,h){N(l,e,h),D(e,t),D(t,n),D(e,s),D(e,i),D(i,a),c||(u=Y(e,"click",r[4]),c=!0)},p(l,h){h&1&&o!==(o=l[0].cards.length==0?"Add a card":"Add another card")&&We(a,o)},i:U,o:U,d(l){l&&x(e),c=!1,u()}}}function al(r){let e,t;return e=new js({props:{placeholder:"Enter a title for this card...",action:"Add Card",class:"add-card-form"}}),e.$on("submit",r[6]),e.$on("close",r[5]),{c(){ne(e.$$.fragment)},m(n,s){K(e,n,s),t=!0},p:U,i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function ll(r){let e,t,n,s,i,o,a,c,u,l=[],h=new Map,f,g,m,$,y,E,O;function L(A){r[11](A)}let B={};r[0].title!==void 0&&(B.value=r[0].title),s=new Zn({props:B}),rt.push(()=>jn(s,"value",L)),s.$on("submit",r[7]);let _=r[0].cards;const T=A=>A[14].id;for(let A=0;A<_.length;A+=1){let R=Or(r,_,A),b=T(R);h.set(b,l[A]=Dr(b,R))}const v=[al,ol],S=[];function M(A,R){return A[3]?0:1}return m=M(r),$=S[m]=v[m](r),{c(){e=I("section"),t=I("div"),n=I("h2"),ne(s.$$.fragment),o=z(),a=I("button"),a.innerHTML='<svg height="20" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-t5efn8"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" class="svelte-t5efn8"></path></svg>',c=z(),u=I("ul");for(let A=0;A<l.length;A+=1)l[A].c();g=z(),$.c(),k(n,"class","svelte-t5efn8"),k(a,"class","menu svelte-t5efn8"),k(t,"class","header svelte-t5efn8"),k(u,"class","svelte-t5efn8"),k(e,"class","svelte-t5efn8"),Ve(e,"collapse",r[1]),Ve(e,"shadow",r[2])},m(A,R){N(A,e,R),D(e,t),D(t,n),K(s,n,null),D(t,o),D(t,a),D(e,c),D(e,u);for(let b=0;b<l.length;b+=1)l[b].m(u,null);D(e,g),S[m].m(e,null),y=!0,E||(O=[Zt(f=Rs.call(null,u,{items:r[0].cards,flipDurationMs:On,dropTargetStyle:"",transformDraggedElement:Ar,type:"card"})),Y(u,"consider",r[10]),Y(u,"finalize",r[9])],E=!0)},p(A,[R]){const b={};if(!i&&R&1&&(i=!0,b.value=A[0].title,Cn(()=>i=!1)),s.$set(b),R&257){_=A[0].cards,Re();for(let d=0;d<l.length;d+=1)l[d].r();l=rs(l,R,T,1,A,_,h,u,si,Dr,null,Or);for(let d=0;d<l.length;d+=1)l[d].a();Ie()}f&&at(f.update)&&R&1&&f.update.call(null,{items:A[0].cards,flipDurationMs:On,dropTargetStyle:"",transformDraggedElement:Ar,type:"card"});let w=m;m=M(A),m===w?S[m].p(A,R):(Re(),P(S[w],1,1,()=>{S[w]=null}),Ie(),$=S[m],$?$.p(A,R):($=S[m]=v[m](A),$.c()),C($,1),$.m(e,null)),R&2&&Ve(e,"collapse",A[1]),R&4&&Ve(e,"shadow",A[2])},i(A){if(!y){C(s.$$.fragment,A);for(let R=0;R<_.length;R+=1)C(l[R]);C($),y=!0}},o(A){P(s.$$.fragment,A);for(let R=0;R<l.length;R+=1)P(l[R]);P($),y=!1},d(A){A&&x(e),X(s);for(let R=0;R<l.length;R+=1)l[R].d();S[m].d(),E=!1,ke(O)}}}const On=200;function Ar(r){r.classList.add("card-dragging")}function cl(r,e,t){let{list:n,collapse:s=!1,shadow:i=!1}=e,o=!1;function a(){t(3,o=!0)}function c(){t(3,o=!1)}async function u(E){const O=await he.cards.create(n,{description:E.detail,position:n.cards.length});n.cards.push(O),t(0,n)}async function l({detail:E}){t(0,n.title=E,n),await he.lists.update(n),t(0,n)}async function h({detail:E},O){O.description=E,await he.cards.update(O)}async function f(E){t(0,n.cards=E.detail.items,n),t(0,n),await he.lists.sort(n)}function g(E){t(0,n.cards=E.detail.items,n),t(0,n)}function m(E){r.$$.not_equal(n.title,E)&&(n.title=E,t(0,n))}function $(E,O){r.$$.not_equal(O.description,E)&&(O.description=E,t(0,n))}const y=(E,O)=>h(O,E);return r.$$set=E=>{"list"in E&&t(0,n=E.list),"collapse"in E&&t(1,s=E.collapse),"shadow"in E&&t(2,i=E.shadow)},[n,s,i,o,a,c,u,l,h,f,g,m,$,y]}class Ps extends Oe{constructor(e){super(),$e(this,e,cl,ll,be,{list:0,collapse:1,shadow:2})}}function ul(r){let e,t,n,s,i,o=r[0]?"Add a list":"Add another list",a,c,u;return{c(){e=I("button"),t=Lt("svg"),n=Lt("path"),s=z(),i=I("span"),a=me(o),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"stroke-width","2"),k(n,"d","M12 6v6m0 0v6m0-6h6m-6 0H6"),k(n,"class","svelte-ho1st4"),k(t,"xmlns","http://www.w3.org/2000/svg"),k(t,"fill","none"),k(t,"viewBox","0 0 24 24"),k(t,"stroke","currentColor"),k(t,"class","svelte-ho1st4"),k(i,"class","svelte-ho1st4"),k(e,"class","svelte-ho1st4")},m(l,h){N(l,e,h),D(e,t),D(t,n),D(e,s),D(e,i),D(i,a),c||(u=Y(e,"click",r[2]),c=!0)},p(l,h){h&1&&o!==(o=l[0]?"Add a list":"Add another list")&&We(a,o)},i:U,o:U,d(l){l&&x(e),c=!1,u()}}}function hl(r){let e,t;return e=new js({props:{placeholder:"Enter a list title...",action:"Add List"}}),e.$on("submit",r[4]),e.$on("close",r[3]),{c(){ne(e.$$.fragment)},m(n,s){K(e,n,s),t=!0},p:U,i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function dl(r){let e,t,n,s;const i=[hl,ul],o=[];function a(c,u){return c[1]?0:1}return t=a(r),n=o[t]=i[t](r),{c(){e=I("section"),n.c(),k(e,"class","svelte-ho1st4"),Ve(e,"adding",r[1])},m(c,u){N(c,e,u),o[t].m(e,null),s=!0},p(c,[u]){let l=t;t=a(c),t===l?o[t].p(c,u):(Re(),P(o[l],1,1,()=>{o[l]=null}),Ie(),n=o[t],n?n.p(c,u):(n=o[t]=i[t](c),n.c()),C(n,1),n.m(e,null)),u&2&&Ve(e,"adding",c[1])},i(c){s||(C(n),s=!0)},o(c){P(n),s=!1},d(c){c&&x(e),o[t].d()}}}function fl(r,e,t){let{first:n=!0}=e;const s=Rn();let i=!1;function o(){t(1,i=!0)}function a(){t(1,i=!1)}async function c(u){s("add",{title:u.detail,cards:[]}),t(1,i=!1)}return r.$$set=u=>{"first"in u&&t(0,n=u.first)},[n,i,o,a,c]}class pl extends Oe{constructor(e){super(),$e(this,e,fl,dl,be,{first:0})}}var xs={exports:{}};(function(r){(function(e){function t(_,T){var v=(_&65535)+(T&65535),S=(_>>16)+(T>>16)+(v>>16);return S<<16|v&65535}function n(_,T){return _<<T|_>>>32-T}function s(_,T,v,S,M,A){return t(n(t(t(T,_),t(S,A)),M),v)}function i(_,T,v,S,M,A,R){return s(T&v|~T&S,_,T,M,A,R)}function o(_,T,v,S,M,A,R){return s(T&S|v&~S,_,T,M,A,R)}function a(_,T,v,S,M,A,R){return s(T^v^S,_,T,M,A,R)}function c(_,T,v,S,M,A,R){return s(v^(T|~S),_,T,M,A,R)}function u(_,T){_[T>>5]|=128<<T%32,_[(T+64>>>9<<4)+14]=T;var v,S,M,A,R,b=1732584193,w=-271733879,d=-1732584194,p=271733878;for(v=0;v<_.length;v+=16)S=b,M=w,A=d,R=p,b=i(b,w,d,p,_[v],7,-680876936),p=i(p,b,w,d,_[v+1],12,-389564586),d=i(d,p,b,w,_[v+2],17,606105819),w=i(w,d,p,b,_[v+3],22,-1044525330),b=i(b,w,d,p,_[v+4],7,-176418897),p=i(p,b,w,d,_[v+5],12,1200080426),d=i(d,p,b,w,_[v+6],17,-1473231341),w=i(w,d,p,b,_[v+7],22,-45705983),b=i(b,w,d,p,_[v+8],7,1770035416),p=i(p,b,w,d,_[v+9],12,-1958414417),d=i(d,p,b,w,_[v+10],17,-42063),w=i(w,d,p,b,_[v+11],22,-1990404162),b=i(b,w,d,p,_[v+12],7,1804603682),p=i(p,b,w,d,_[v+13],12,-40341101),d=i(d,p,b,w,_[v+14],17,-1502002290),w=i(w,d,p,b,_[v+15],22,1236535329),b=o(b,w,d,p,_[v+1],5,-165796510),p=o(p,b,w,d,_[v+6],9,-1069501632),d=o(d,p,b,w,_[v+11],14,643717713),w=o(w,d,p,b,_[v],20,-373897302),b=o(b,w,d,p,_[v+5],5,-701558691),p=o(p,b,w,d,_[v+10],9,38016083),d=o(d,p,b,w,_[v+15],14,-660478335),w=o(w,d,p,b,_[v+4],20,-405537848),b=o(b,w,d,p,_[v+9],5,568446438),p=o(p,b,w,d,_[v+14],9,-1019803690),d=o(d,p,b,w,_[v+3],14,-187363961),w=o(w,d,p,b,_[v+8],20,1163531501),b=o(b,w,d,p,_[v+13],5,-1444681467),p=o(p,b,w,d,_[v+2],9,-51403784),d=o(d,p,b,w,_[v+7],14,1735328473),w=o(w,d,p,b,_[v+12],20,-1926607734),b=a(b,w,d,p,_[v+5],4,-378558),p=a(p,b,w,d,_[v+8],11,-2022574463),d=a(d,p,b,w,_[v+11],16,1839030562),w=a(w,d,p,b,_[v+14],23,-35309556),b=a(b,w,d,p,_[v+1],4,-1530992060),p=a(p,b,w,d,_[v+4],11,1272893353),d=a(d,p,b,w,_[v+7],16,-155497632),w=a(w,d,p,b,_[v+10],23,-1094730640),b=a(b,w,d,p,_[v+13],4,681279174),p=a(p,b,w,d,_[v],11,-358537222),d=a(d,p,b,w,_[v+3],16,-722521979),w=a(w,d,p,b,_[v+6],23,76029189),b=a(b,w,d,p,_[v+9],4,-640364487),p=a(p,b,w,d,_[v+12],11,-421815835),d=a(d,p,b,w,_[v+15],16,530742520),w=a(w,d,p,b,_[v+2],23,-995338651),b=c(b,w,d,p,_[v],6,-198630844),p=c(p,b,w,d,_[v+7],10,1126891415),d=c(d,p,b,w,_[v+14],15,-1416354905),w=c(w,d,p,b,_[v+5],21,-57434055),b=c(b,w,d,p,_[v+12],6,1700485571),p=c(p,b,w,d,_[v+3],10,-1894986606),d=c(d,p,b,w,_[v+10],15,-1051523),w=c(w,d,p,b,_[v+1],21,-2054922799),b=c(b,w,d,p,_[v+8],6,1873313359),p=c(p,b,w,d,_[v+15],10,-30611744),d=c(d,p,b,w,_[v+6],15,-1560198380),w=c(w,d,p,b,_[v+13],21,1309151649),b=c(b,w,d,p,_[v+4],6,-145523070),p=c(p,b,w,d,_[v+11],10,-1120210379),d=c(d,p,b,w,_[v+2],15,718787259),w=c(w,d,p,b,_[v+9],21,-343485551),b=t(b,S),w=t(w,M),d=t(d,A),p=t(p,R);return[b,w,d,p]}function l(_){var T,v="",S=_.length*32;for(T=0;T<S;T+=8)v+=String.fromCharCode(_[T>>5]>>>T%32&255);return v}function h(_){var T,v=[];for(v[(_.length>>2)-1]=void 0,T=0;T<v.length;T+=1)v[T]=0;var S=_.length*8;for(T=0;T<S;T+=8)v[T>>5]|=(_.charCodeAt(T/8)&255)<<T%32;return v}function f(_){return l(u(h(_),_.length*8))}function g(_,T){var v,S=h(_),M=[],A=[],R;for(M[15]=A[15]=void 0,S.length>16&&(S=u(S,_.length*8)),v=0;v<16;v+=1)M[v]=S[v]^909522486,A[v]=S[v]^1549556828;return R=u(M.concat(h(T)),512+T.length*8),l(u(A.concat(R),512+128))}function m(_){var T="0123456789abcdef",v="",S,M;for(M=0;M<_.length;M+=1)S=_.charCodeAt(M),v+=T.charAt(S>>>4&15)+T.charAt(S&15);return v}function $(_){return unescape(encodeURIComponent(_))}function y(_){return f($(_))}function E(_){return m(y(_))}function O(_,T){return g($(_),$(T))}function L(_,T){return m(O(_,T))}function B(_,T,v){return T?v?O(T,_):L(T,_):v?y(_):E(_)}r.exports?r.exports=B:e.md5=B})(as)})(xs);var ml=xs.exports;function gl(r){return Array.isArray(r)&&(r=r.join("")),ml(r)}function Rr(r,e){if(!r)throw new Error("Please specify an identifier, such as an email address");r.includes("@")&&(r=r.toLowerCase().trim());const t=new URL("https://gravatar.com/avatar/");return t.pathname+=gl(r),t.search=new URLSearchParams(e),t.toString()}function _l(r){let e,t,n,s,i,o,a;const c=r[3].default,u=Fr(c,r,r[2],null);return{c(){e=I("header"),t=I("span"),n=z(),u&&u.c(),s=z(),i=I("img"),k(t,"class","svelte-1nxxkum"),er(i.src,o=Rr(r[0].email,{size:40}))||k(i,"src",o),k(i,"alt","Gravatar"),k(i,"class","svelte-1nxxkum"),k(e,"class","svelte-1nxxkum")},m(l,h){N(l,e,h),D(e,t),D(e,n),u&&u.m(e,null),D(e,s),D(e,i),a=!0},p(l,[h]){u&&u.p&&(!a||h&4)&&zr(u,c,l,l[2],a?Gr(c,l[2],h,null):qr(l[2]),null),(!a||h&1&&!er(i.src,o=Rr(l[0].email,{size:40})))&&k(i,"src",o)},i(l){a||(C(u,l),a=!0)},o(l){P(u,l),a=!1},d(l){l&&x(e),u&&u.d(l)}}}function vl(r,e,t){let n,{$$slots:s={},$$scope:i}=e;const o=he.user;return Br(r,o,a=>t(0,n=a)),r.$$set=a=>{"$$scope"in a&&t(2,i=a.$$scope)},[n,o,i,s]}class Ns extends Oe{constructor(e){super(),$e(this,e,vl,_l,be,{})}}function Ir(r,e,t){const n=r.slice();return n[8]=e[t],n}function Cr(r){let e,t,n;function s(o){r[7](o)}let i={};return r[1].title!==void 0&&(i.value=r[1].title),e=new Zn({props:i}),rt.push(()=>jn(e,"value",s)),e.$on("submit",r[3]),{c(){ne(e.$$.fragment)},m(o,a){K(e,o,a),n=!0},p(o,a){const c={};!t&&a&2&&(t=!0,c.value=o[1].title,Cn(()=>t=!1)),e.$set(c)},i(o){n||(C(e.$$.fragment,o),n=!0)},o(o){P(e.$$.fragment,o),n=!1},d(o){X(e,o)}}}function yl(r){let e,t,n=r[1]&&Cr(r);return{c(){n&&n.c(),e=gt()},m(s,i){n&&n.m(s,i),N(s,e,i),t=!0},p(s,i){s[1]?n?(n.p(s,i),i&2&&C(n,1)):(n=Cr(s),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Re(),P(n,1,1,()=>{n=null}),Ie())},i(s){t||(C(n),t=!0)},o(s){P(n),t=!1},d(s){n&&n.d(s),s&&x(e)}}}function bl(r){let e,t=[],n=new Map,s,i,o,a,c,u,l=r[1].lists;const h=f=>f[8].id;for(let f=0;f<l.length;f+=1){let g=Ir(r,l,f),m=h(g);n.set(m,t[f]=Pr(m,g))}return o=new pl({props:{first:r[1].lists.length==0}}),o.$on("add",r[2]),{c(){e=I("div");for(let f=0;f<t.length;f+=1)t[f].c();i=z(),ne(o.$$.fragment),k(e,"class","svelte-1wsxqwl")},m(f,g){N(f,e,g);for(let m=0;m<t.length;m+=1)t[m].m(e,null);N(f,i,g),K(o,f,g),a=!0,c||(u=[Zt(s=Rs.call(null,e,{items:r[1].lists,flipDurationMs:xr,dropTargetStyle:"",transformDraggedElement:Nr,type:"board"})),Y(e,"consider",r[4]),Y(e,"finalize",r[5])],c=!0)},p(f,g){g&2&&(l=f[1].lists,Re(),t=rs(t,g,h,1,f,l,n,e,ns,Pr,null,Ir),Ie()),s&&at(s.update)&&g&2&&s.update.call(null,{items:f[1].lists,flipDurationMs:xr,dropTargetStyle:"",transformDraggedElement:Nr,type:"board"});const m={};g&2&&(m.first=f[1].lists.length==0),o.$set(m)},i(f){if(!a){for(let g=0;g<l.length;g+=1)C(t[g]);C(o.$$.fragment,f),a=!0}},o(f){for(let g=0;g<t.length;g+=1)P(t[g]);P(o.$$.fragment,f),a=!1},d(f){f&&x(e);for(let g=0;g<t.length;g+=1)t[g].d();f&&x(i),X(o,f),c=!1,ke(u)}}}function wl(r){let e;return{c(){e=me("Loading...")},m(t,n){N(t,e,n)},p:U,i:U,o:U,d(t){t&&x(e)}}}function jr(r){let e,t,n,s,i;return t=new Ps({props:{list:r[8],shadow:!0}}),{c(){e=I("div"),ne(t.$$.fragment),n=z(),k(e,"class","drag-shadow svelte-1wsxqwl")},m(o,a){N(o,e,a),K(t,e,null),D(e,n),i=!0},p(o,a){r=o;const c={};a&2&&(c.list=r[8]),t.$set(c)},i(o){i||(C(t.$$.fragment,o),s||Le(()=>{s=Vt(e,Jn,{duration:200,easing:Is}),s.start()}),i=!0)},o(o){P(t.$$.fragment,o),i=!1},d(o){o&&x(e),X(t)}}}function Pr(r,e){let t,n,s,i,o;n=new Ps({props:{list:e[8],collapse:e[8][Te]}});let a=e[8][Te]&&jr(e);return{key:r,first:null,c(){t=gt(),ne(n.$$.fragment),s=z(),a&&a.c(),i=gt(),this.first=t},m(c,u){N(c,t,u),K(n,c,u),N(c,s,u),a&&a.m(c,u),N(c,i,u),o=!0},p(c,u){e=c;const l={};u&2&&(l.list=e[8]),u&2&&(l.collapse=e[8][Te]),n.$set(l),e[8][Te]?a?(a.p(e,u),u&2&&C(a,1)):(a=jr(e),a.c(),C(a,1),a.m(i.parentNode,i)):a&&(Re(),P(a,1,1,()=>{a=null}),Ie())},i(c){o||(C(n.$$.fragment,c),C(a),o=!0)},o(c){P(n.$$.fragment,c),P(a),o=!1},d(c){c&&x(t),X(n,c),c&&x(s),a&&a.d(c),c&&x(i)}}}function El(r){var f;let e,t,n,s,i,o,a,c;document.title=e=(f=r[1])==null?void 0:f.title,n=new Ns({props:{$$slots:{default:[yl]},$$scope:{ctx:r}}});const u=[wl,bl],l=[];function h(g,m){return g[0]?0:1}return o=h(r),a=l[o]=u[o](r),{c(){t=z(),ne(n.$$.fragment),s=z(),i=I("main"),a.c(),k(i,"class","svelte-1wsxqwl")},m(g,m){N(g,t,m),K(n,g,m),N(g,s,m),N(g,i,m),l[o].m(i,null),c=!0},p(g,[m]){var E;(!c||m&2)&&e!==(e=(E=g[1])==null?void 0:E.title)&&(document.title=e);const $={};m&2050&&($.$$scope={dirty:m,ctx:g}),n.$set($);let y=o;o=h(g),o===y?l[o].p(g,m):(Re(),P(l[y],1,1,()=>{l[y]=null}),Ie(),a=l[o],a?a.p(g,m):(a=l[o]=u[o](g),a.c()),C(a,1),a.m(i,null))},i(g){c||(C(n.$$.fragment,g),C(a),c=!0)},o(g){P(n.$$.fragment,g),P(a),c=!1},d(g){g&&x(t),X(n,g),g&&x(s),g&&x(i),l[o].d()}}}const xr=200;function Nr(r){r.classList.add("list-dragging")}function Tl(r,e,t){let n=!0,s,{id:i}=e;wt(()=>{he.boards.get(i).then(h=>{t(1,s=h),t(0,n=!1)})});async function o({detail:h}){const f=await he.lists.create(s,{title:h.title,position:s.lists.length});s.lists.push(f),t(1,s)}async function a({detail:h}){t(1,s.title=h,s),await he.boards.update(s),t(1,s)}function c(h){t(1,s.lists=h.detail.items,s),t(1,s)}async function u(h){t(1,s.lists=h.detail.items,s),t(1,s),await he.boards.sort(s)}function l(h){r.$$.not_equal(s.title,h)&&(s.title=h,t(1,s))}return r.$$set=h=>{"id"in h&&t(6,i=h.id)},[n,s,o,a,c,u,i,l]}class kl extends Oe{constructor(e){super(),$e(this,e,Tl,El,be,{id:6})}}function Lr(r,e,t){const n=r.slice();return n[3]=e[t],n}function $l(r){let e;return{c(){e=me("Boards")},m(t,n){N(t,e,n)},d(t){t&&x(e)}}}function Mr(r){let e,t,n=r[3].title+"",s,i;return{c(){e=I("li"),t=I("a"),s=me(n),k(t,"href",i="/boards/"+r[3].id),k(t,"class","svelte-g2iuh6"),k(e,"class","svelte-g2iuh6")},m(o,a){N(o,e,a),D(e,t),D(t,s)},p(o,a){a&1&&n!==(n=o[3].title+"")&&We(s,n),a&1&&i!==(i="/boards/"+o[3].id)&&k(t,"href",i)},d(o){o&&x(e)}}}function Ol(r){let e,t,n,s,i,o,a,c,u=r[0].length==0?"Add a board":"Add another board",l,h,f,g;t=new Ns({props:{$$slots:{default:[$l]},$$scope:{ctx:r}}});let m=r[0],$=[];for(let y=0;y<m.length;y+=1)$[y]=Mr(Lr(r,m,y));return{c(){e=z(),ne(t.$$.fragment),n=z(),s=I("main"),i=I("ul");for(let y=0;y<$.length;y+=1)$[y].c();o=z(),a=I("li"),c=I("button"),l=me(u),document.title="Boards",k(c,"class","svelte-g2iuh6"),k(a,"class","add svelte-g2iuh6"),k(i,"class","svelte-g2iuh6"),k(s,"class","svelte-g2iuh6")},m(y,E){N(y,e,E),K(t,y,E),N(y,n,E),N(y,s,E),D(s,i);for(let O=0;O<$.length;O+=1)$[O].m(i,null);D(i,o),D(i,a),D(a,c),D(c,l),h=!0,f||(g=Y(c,"click",r[1]),f=!0)},p(y,[E]){const O={};if(E&64&&(O.$$scope={dirty:E,ctx:y}),t.$set(O),E&1){m=y[0];let L;for(L=0;L<m.length;L+=1){const B=Lr(y,m,L);$[L]?$[L].p(B,E):($[L]=Mr(B),$[L].c(),$[L].m(i,o))}for(;L<$.length;L+=1)$[L].d(1);$.length=m.length}(!h||E&1)&&u!==(u=y[0].length==0?"Add a board":"Add another board")&&We(l,u)},i(y){h||(C(t.$$.fragment,y),h=!0)},o(y){P(t.$$.fragment,y),h=!1},d(y){y&&x(e),X(t,y),y&&x(n),y&&x(s),Ws($,y),f=!1,g()}}}function Sl(r,e,t){let n=[];wt(async()=>{t(0,n=await he.boards.all())});async function s(){const i=await he.boards.create({title:"Untitled",position:n.length});xt.goto(`/boards/${i.id}`)}return[n,s]}class Dl extends Oe{constructor(e){super(),$e(this,e,Sl,Ol,be,{})}}function Al(r){let e,t,n,s,i,o,a,c,u,l,h,f,g;return{c(){e=I("div"),t=I("h1"),t.textContent="Sign in",n=z(),s=I("form"),i=I("label"),o=I("span"),o.textContent="E-mail Address",a=z(),c=I("input"),u=z(),l=I("button"),l.innerHTML=`<svg class="icon svelte-1dvq50f" height="24" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" class="svelte-1dvq50f"></path></svg> 
          <span class="svelte-1dvq50f">Send me a magic link</span>`,k(t,"class","svelte-1dvq50f"),k(o,"class","svelte-1dvq50f"),k(c,"name","email"),k(c,"type","email"),c.required=!0,k(c,"class","svelte-1dvq50f"),k(i,"class","svelte-1dvq50f"),k(l,"class","svelte-1dvq50f"),k(s,"class","svelte-1dvq50f"),k(e,"class","container svelte-1dvq50f")},m(m,$){N(m,e,$),D(e,t),D(e,n),D(e,s),D(s,i),D(i,o),D(i,a),D(i,c),nt(c,r[0]),D(s,u),D(s,l),f||(g=[Y(c,"input",r[3]),Zt(Cl.call(null,c)),Y(s,"submit",An(r[2]))],f=!0)},p(m,$){$&1&&c.value!==m[0]&&nt(c,m[0])},i(m){h||Le(()=>{h=Vt(e,Jn,{}),h.start()})},o:U,d(m){m&&x(e),f=!1,ke(g)}}}function Rl(r){let e,t,n;return{c(){e=I("div"),t=I("div"),t.innerHTML=`<svg class="icon svelte-1dvq50f" height="32" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-1dvq50f"></path></svg> 
        <h2 class="svelte-1dvq50f">Sent you a link, check your email</h2>`,k(t,"class","notification svelte-1dvq50f"),k(e,"class","container svelte-1dvq50f")},m(s,i){N(s,e,i),D(e,t)},p:U,i(s){n||Le(()=>{n=Vt(t,Ka,{}),n.start()})},o:U,d(s){s&&x(e)}}}function Il(r){let e,t;function n(o,a){return o[1]?Rl:Al}let s=n(r),i=s(r);return{c(){e=z(),t=I("div"),i.c(),document.title="Kanban",k(t,"class","wrapper svelte-1dvq50f")},m(o,a){N(o,e,a),N(o,t,a),i.m(t,null)},p(o,[a]){s===(s=n(o))&&i?i.p(o,a):(i.d(1),i=s(o),i&&(i.c(),C(i,1),i.m(t,null)))},i(o){C(i)},o:U,d(o){o&&x(e),o&&x(t),i.d()}}}function Cl(r){r.focus()}function jl(r,e,t){let n,s=!1;async function i(){await he.signIn(n),t(1,s=!0)}function o(){n=this.value,t(0,n)}return[n,s,i,o]}class Pl extends Oe{constructor(e){super(),$e(this,e,jl,Il,be,{})}}function xl(r){let e,t;return e=new Bt({props:{path:"/",$$slots:{default:[Ll]},$$scope:{ctx:r}}}),{c(){ne(e.$$.fragment)},m(n,s){K(e,n,s),t=!0},p(n,s){const i={};s&8&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Nl(r){let e,t,n,s;return e=new Bt({props:{path:"/",$$slots:{default:[Ml]},$$scope:{ctx:r}}}),n=new Bt({props:{path:"/boards/:id",$$slots:{default:[Ul,({meta:i})=>({2:i}),({meta:i})=>i?4:0]},$$scope:{ctx:r}}}),{c(){ne(e.$$.fragment),t=z(),ne(n.$$.fragment)},m(i,o){K(e,i,o),N(i,t,o),K(n,i,o),s=!0},p(i,o){const a={};o&8&&(a.$$scope={dirty:o,ctx:i}),e.$set(a);const c={};o&12&&(c.$$scope={dirty:o,ctx:i}),n.$set(c)},i(i){s||(C(e.$$.fragment,i),C(n.$$.fragment,i),s=!0)},o(i){P(e.$$.fragment,i),P(n.$$.fragment,i),s=!1},d(i){X(e,i),i&&x(t),X(n,i)}}}function Ll(r){let e,t;return e=new Pl({}),{c(){ne(e.$$.fragment)},m(n,s){K(e,n,s),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Ml(r){let e,t;return e=new Dl({}),{c(){ne(e.$$.fragment)},m(n,s){K(e,n,s),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Ul(r){let e,t;return e=new kl({props:{id:r[2].params.id}}),{c(){ne(e.$$.fragment)},m(n,s){K(e,n,s),t=!0},p(n,s){const i={};s&4&&(i.id=n[2].params.id),e.$set(i)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Bl(r){let e;return{c(){e=me("Aw shucks. That couldn't be found.")},m(t,n){N(t,e,n)},d(t){t&&x(e)}}}function Fl(r){let e,t,n,s,i;const o=[Nl,xl],a=[];function c(u,l){return u[0]?0:1}return e=c(r),t=a[e]=o[e](r),s=new Bt({props:{fallback:!0,$$slots:{default:[Bl]},$$scope:{ctx:r}}}),{c(){t.c(),n=z(),ne(s.$$.fragment)},m(u,l){a[e].m(u,l),N(u,n,l),K(s,u,l),i=!0},p(u,[l]){let h=e;e=c(u),e===h?a[e].p(u,l):(Re(),P(a[h],1,1,()=>{a[h]=null}),Ie(),t=a[e],t?t.p(u,l):(t=a[e]=o[e](u),t.c()),C(t,1),t.m(n.parentNode,n));const f={};l&8&&(f.$$scope={dirty:l,ctx:u}),s.$set(f)},i(u){i||(C(t),C(s.$$.fragment,u),i=!0)},o(u){P(t),P(s.$$.fragment,u),i=!1},d(u){a[e].d(u),u&&x(n),X(s,u)}}}function Hl(r,e,t){let n,s=he.user;return Br(r,s,i=>t(0,n=i)),[n,s]}class Gl extends Oe{constructor(e){super(),$e(this,e,Hl,Fl,be,{})}}new Gl({target:document.body});
